---
layout: single
title:  "[ë¨¸ì‹ ëŸ¬ë‹] ë¨¸ì‹ ëŸ¬ë‹ì„ ì´ìš©í•˜ì—¬ Web App êµ¬ì¶•í•˜ê¸°"
categories: 
  - Machine_Learning
tag: [python, blog, machinelearning]
toc: true
use_math: true
author_profile: false
---





ğŸ±â€ğŸ‘“ Scikit-learn ëª¨ë¸ì„ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ ì˜ˆì¸¡í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì. ëª¨ë¸ì´ ì €ì¥ë˜ë©´ Flaskì— ë‚´ì¥ëœ ì›¹ ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆë‹¤. 

<br>

ğŸ±â€ğŸ‘“ ì´ ê¸€ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì— ëŒ€í•´ ì•Œì•„ë³¼ ê²ƒì´ë‹¤.

- í›ˆë ¨ëœ ëª¨ë¸ì„ **'pickle'**í•˜ëŠ” ë°©ë²•
- **Flask ì•±**ì—ì„œ í•´ë‹¹ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

<br>



ğŸš€ ë¨¼ì € *UFO ëª©ê²©* ì— ê´€í•œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ ë§Œë“¤ê³ , ëª‡ ì´ˆ ë™ì•ˆ ìœ„ë„ ë° ê²½ë„ ê°’ì„ ì…ë ¥ë°›ê³  ì´ ê°’ìœ¼ë¡œ **UFOë¥¼ ë³´ê³ í•œ êµ­ê°€ë¥¼ ì˜ˆì¸¡**í•  ìˆ˜ ìˆëŠ” ì›¹ ì•±ì„ êµ¬ì¶•í•´ë³´ì.

- NUFORCì˜ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ *ì§€ë‚œ ì„¸ê¸°ì˜ UFO ëª©ê²©ë‹´* ê³¼ ê°™ì€ ì´ ì„¸ìƒê³¼ëŠ” ë‹¤ë¥¸ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¬ ê²ƒì´ë‹¤.

<br>

<br>

### ì•± êµ¬ì¶•í•˜ê¸°

ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ ì•±ì„ êµ¬ì¶•í•˜ëŠ” ë°ëŠ” ëª‡ ê°€ì§€ ë°©ë²•ì´ ìˆìœ¼ë©°, **ì›¹ ì•„í‚¤í…ì²˜**ëŠ” ëª¨ë¸ í›ˆë ¨ ë°©ì‹ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤. 



**Considerations**

ë°ì´í„° ê³¼í•™ ê·¸ë£¹ì´ ì•±ì—ì„œ ì‚¬ìš©í•˜ê¸°ë¥¼ ì›í•˜ëŠ” ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ê¸°ì—…ì—ì„œ ì¼í•˜ê³  ìˆë‹¤ê³  ê°€ì •í•œë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ ë§ì€ ì§ˆë¬¸ì„ í•´ì•¼ í•œë‹¤.

- **ì›¹ ì•±ì¸ê°€, ëª¨ë°”ì¼ ì•±ì¸ê°€?**  
  - `ëª¨ë°”ì¼ ì•±`ì„ êµ¬ì¶•í•˜ê±°ë‚˜ `IoT ì»¨í…ìŠ¤íŠ¸`ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš° **[TensorFlow Lite](https://www.tensorflow.org/lite/)**ë¥¼ ì‚¬ìš©í•´ ì•ˆë“œë¡œì´ë“œ ë˜ëŠ” iOS ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

- **ëª¨ë¸ì˜ ìœ„ì¹˜ëŠ” ì–´ë””ì¸ê°€?**  
  - **í´ë¼ìš°ë“œ**ì— ìœ„ì¹˜í•˜ëŠ”ì§€ ë˜ëŠ” **ë¡œì»¬**ì— ìœ„ì¹˜í•˜ëŠ”ì§€

- **ì˜¤í”„ë¼ì¸ ì§€ì›**
  - ì•±ì´ ì˜¤í”„ë¼ì¸ì—ì„œ ì‘ë™í•´ì•¼ í•˜ëŠ”ê°€?

- **ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ë° ì–´ë–¤ ê¸°ìˆ ì´ ì‚¬ìš©ë˜ì—ˆëŠ”ê°€?**  *ì„ íƒí•œ ê¸°ìˆ ì´ ì‚¬ìš©í•˜ëŠ” íˆ´ë§ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤.*
  - **TensorFlow ì‚¬ìš©**: TensorFlowë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ê²½ìš°, í•´ë‹¹ í™˜ê²½ì€  [TensorFlow.js](https://www.tensorflow.org/js/)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ TensorFlow ëª¨ë¸ì„ ë³€í™˜í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.
  - **PyTorch ì‚¬ìš©**: [PyTorch](https://pytorch.org/)ì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ ì‘ì„±í•˜ëŠ” ê²½ìš°,  [Onnx Runtime](https://www.onnxruntime.ai/)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” JavaScript ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ëª¨ë¸ì„ [ONNX](https://onnx.ai/)(Open Neural Network Exchange) í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆë‹¤. 
  - **Lobe.ai ë˜ëŠ” Azure Custom Vision ì‚¬ìš©**: [Lobe.ai](https://lobe.ai/) ë˜ëŠ” [Azure Custom Vision](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-15963-cxa)ê³¼ ê°™ì€ ë¨¸ì‹ ëŸ¬ë‹  *SaaS(Software as a Service) ì‹œìŠ¤í…œ* ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ê²½ìš°, ì´ ìœ í˜•ì˜ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ì˜¨ë¼ì¸ ì•±ì—ì„œ í´ë¼ìš°ë“œì—ì„œ ìš”ì²­ì„ ë°›ëŠ” **ë§ì¶¤í˜• API êµ¬ì¶•** ì„ í¬í•¨í•˜ì—¬ ì—¬ëŸ¬ í”Œë«í¼ì— ëŒ€í•´ ëª¨ë¸ì„ ë‚´ë³´ë‚¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤.
  - ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ëª¨ë¸ ìì²´ë¥¼ í›ˆë ¨í•  ìˆ˜ ìˆëŠ” **ì „ì²´ Flask ì›¹ ì•±**ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
    - JavaScript contextì—ì„œ TensorFlow.jsë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

Python ê¸°ë°˜ ë…¸íŠ¸ë¶ìœ¼ë¡œ ì‘ì—…í•´ ì™”ê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ë…¸íŠ¸ë¶ì—ì„œ Pythonì´ êµ¬ì¶•í•œ ì›¹ ì•±ì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ í›ˆë ¨ëœ ëª¨ë¸ì„ ë‚´ë³´ë‚´ëŠ” ë° í•„ìš”í•œ ë‹¨ê³„ë¥¼ ì‚´í´ë³´ì.

<br>

<br>

### Tool

ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë‘ ê°€ì§€ ë„êµ¬ê°€ í•„ìš”í•˜ë‹¤. (*ë‘ ê°€ì§€ ëª¨ë‘ íŒŒì´ì¬ì—ì„œ ì‘ë™í•œë‹¤.*)

ğŸ“Œ **Flask**

 ì œì‘ìë“¤ì—ê²Œ *'micro-framework'*ë¡œ ì •ì˜ë˜ëŠ” FlaskëŠ” íŒŒì´ì¬ì„ ì‚¬ìš©í•˜ëŠ” **ì›¹ í”„ë ˆì„ì›Œí¬ì˜ ê¸°ë³¸ ê¸°ëŠ¥**ê³¼ ì›¹ í˜ì´ì§€ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•œ **í…œí”Œë¦¿ ì—”ì§„**ì„ ì œê³µí•œë‹¤. 

- (ì°¸ê³ ) Flaskë¡œ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ì—°ìŠµí•˜ë ¤ë©´ ì´ [í•™ìŠµ ëª¨ë“ˆ](https://docs.microsoft.com/learn/modules/python-flask-build-ai-web-app?WT.mc_id=academic-15963-cxa)ì„ í™•ì¸í•´ë³´ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤. 



ğŸ“Œ **Pickle**

Pickleì€ íŒŒì´ì¬ ê°ì²´ êµ¬ì¡°ë¥¼ ì§ë ¬í™”í•˜ê³  ì—­ì•”í˜¸í™”í•˜ëŠ” íŒŒì´ì¬ ëª¨ë“ˆì´ë‹¤. ëª¨ë¸ì„ 'pickle'í•  ë•Œ **ì›¹ì—ì„œ ì‚¬ìš©**í•˜ê¸° ìœ„í•´ **ëª¨ë¸ì„ ì§ë ¬í™”**í•˜ê±°ë‚˜ **êµ¬ì¡°ë¥¼ í‰í‰**í•˜ê²Œ ë§Œë“ ë‹¤. 

- pickleì€ ë³¸ì§ˆì ìœ¼ë¡œ ì•ˆì „í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ íŒŒì¼ì„ 'un-pickle'í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ í‘œì‹œë˜ë©´ ì£¼ì˜í•´ì•¼ í•œë‹¤.
- pickle íŒŒì¼ì˜ í™•ì¥ìëŠ” `.pkl`ì´ë‹¤.



<br>

<br>

### Exercise - ë°ì´í„° ì •ì œ

[NUFORC](https://nuforc.org/)(National UFO Reporting Center)ê°€ ìˆ˜ì§‘í•œ **8ë§Œ ê±´ì˜ UFO ëª©ê²© ë°ì´í„°**ë¥¼ ì‚¬ìš©í•œë‹¤. 

> *UFO ëª©ê²©ë°ì´í„° ì˜ˆì‹œ*
>
> - *"A man emerges from a beam of light that shines on a grassy field at night and he runs towards the Texas Instruments parking lot"*
> - *'the lights chased us'*



*[ufos.csv](https://github.com/codingalzi/ML-For-Beginners/blob/main/3-Web-App/1-Web-App/data/ufos.csv)* ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ëŠ” ëª©ê²©ì´ ë°œìƒí•œ ë„ì‹œ*`city`*, ì£¼*`state`* ë° êµ­ê°€*`country`* , ê°ì²´ì˜ ëª¨ì–‘*`shape`*, ìœ„ë„*`latitude`* ë° ê²½ë„*`longitude`*ì— ëŒ€í•œ ì—´ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.



1. `pandas`, `matplotlib`,  `numpy` ë¥¼ import í•˜ê³  UFO ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ë¥¼ ê°€ì ¸ì˜¨ë‹¤. 

   ```python
   import pandas as pd
   import numpy as np
   
   # ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
   # ë°ì´í„°ë¥¼ ì—…ë¡œë“œ í•˜ì§€ ì•Šê³  íŒŒì¼ì„ ê°€ì ¸ì˜¤ë ¤ë©´ ì£¼ì†Œë¥¼ 'https://raw.githubusercontent.com/codingalzi/ML-For-Beginners/main/3-Web-App/1-Web-App/data/ufos.csv' ë¡œ ëŒ€ì²´í•œë‹¤.
   ufos = pd.read_csv('./data/ufos.csv')
   
   
   ufos.head()
   ```

   | index | datetime         | city                  | state | country | shape    | duration \(seconds) | duration \(hours/min) | comments                                                     | date posted | latitude    | longitude     |
   | ----- | ---------------- | --------------------- | ----- | ------- | -------- | ------------------- | --------------------- | ------------------------------------------------------------ | :---------- | ----------- | ------------- |
   | 0     | 10/10/1949 20:30 | san marcos            | tx    | us      | cylinder | 2700                | 45 minutes            | This event took place in early fall around 1949-50\. It occurred after a Boy Scout meeting in the Baptist Church. The Baptist Church sit | 4/27/2004   | 29\.8830556 | -97\.9411111  |
   | 1     | 10/10/1949 21:00 | lackland afb          | tx    | NaN     | light    | 7200                | 1-2 hrs               | 1949 Lackland AFB&\#44 TX.  Lights racing across the sky &amp; making 90 degree turns on a dime. | 12/16/2005  | 29\.38421   | -98\.581082   |
   | 2     | 10/10/1955 17:00 | chester \(uk/england) | NaN   | gb      | circle   | 20                  | 20 seconds            | Green/Orange circular disc over Chester&\#44 England         | 1/21/2008   | 53\.2       | -2\.916667    |
   | 3     | 10/10/1956 21:00 | edna                  | tx    | us      | circle   | 20                  | 1/2 hour              | My older brother and twin sister were leaving the only Edna theater at about 9 PM&\#44...we had our bikes and I took a different route home | 1/17/2004   | 28\.9783333 | -96\.6458333  |
   | 4     | 10/10/1960 20:00 | kaneohe               | hi    | us      | light    | 900                 | 15 minutes            | AS a Marine 1st Lt\. flying an FJ4B fighter/attack aircraft on a solo night exercise&#44 I was at 50&#44000&#39 in a &quot;clean&quot; aircraft (no ordinan | 1/22/2004   | 21\.4180556 | -157\.8036111 |

   <br>

2. ufos ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ íƒ€ì´í‹€ì„ ê°–ëŠ” **ì‘ì€ ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜**í•˜ê³ , `Country` í•„ë“œì˜ **ê³ ìœ í•œ ê°’**ì„ í™•ì¸í•œë‹¤.

   ```python
   # {'íƒ€ì´í‹€': ë°ì´í„°} ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ íƒ€ì´í‹€ì„ ê°–ëŠ” ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜
   ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})
   
   # ë°ì´í„° í”„ë ˆì„ì˜ Country í•„ë“œì˜ ê³ ìœ ê°’ í™•ì¸
   ufos.Country.unique()
   ```

   ```output
   array(['us', nan, 'gb', 'ca', 'au', 'de'], dtype=object)
   ```

   <br>

3. ì´ì œ **null ê°’ì„ ì‚­ì œ**í•˜ê³  `Seconds`í•„ë“œì—ì„œ **1~60ì´ˆ ì‚¬ì´ì˜ ëª©ê²© ì •ë³´**ë§Œ ê°€ì ¸ì™€ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ë°ì´í„° ì–‘ì„ ì¤„ì¸ë‹¤.

   ```python
   # null ê°’ ì‚­ì œ
   ufos.dropna(inplace=True)
   
   # 1~60ì´ˆ ì‚¬ì´ì˜ ëª©ê²© ì •ë³´ë§Œ ê°€ì ¸ì˜¤ê¸°
   ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]
   
   ufos.info()
   ```

   ```output
   <class 'pandas.core.frame.DataFrame'>
   Int64Index: 25863 entries, 2 to 80330
   Data columns (total 4 columns):
    #   Column     Non-Null Count  Dtype  
   ---  ------     --------------  -----  
    0   Seconds    25863 non-null  float64
    1   Country    25863 non-null  object 
    2   Latitude   25863 non-null  float64
    3   Longitude  25863 non-null  float64
   dtypes: float64(3), object(1)
   memory usage: 1010.3+ KB
   ```

   <br>

4. `Scikit-learn`ì˜ `LabelEncoder` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì™€ì„œ **êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’**ì„ **ìˆ«ìë¡œ ë³€í™˜**í•œë‹¤.

   ğŸŒº `LabelEncoder`ëŠ” ë°ì´í„°ë¥¼ ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì¸ì½”ë”©í•œë‹¤.

   ```python
   from sklearn.preprocessing import LabelEncoder
   
   # 'Country' í•„ë“œì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜
   ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])
   
   ufos.head()
   ```

   | index | Seconds | Country | Latitude    | Longitude     |
   | ----- | ------- | ------- | ----------- | ------------- |
   | 2     | 20\.0   | 3       | 53\.2       | -2\.916667    |
   | 3     | 20\.0   | 4       | 28\.9783333 | -96\.6458333  |
   | 14    | 30\.0   | 4       | 35\.8238889 | -80\.2536111  |
   | 23    | 60\.0   | 4       | 45\.5827778 | -122\.3522222 |
   | 24    | 3\.0    | 3       | 51\.783333  | -0\.783333    |

<br>

<br>

### Exercise - ëª¨ë¸ êµ¬ì¶•

ì´ì œ ë°ì´í„°ë¥¼ í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëª¨ë¸ì„ í›ˆë ¨í•  ì¤€ë¹„ë¥¼ í•  ìˆ˜ ìˆë‹¤.



1. X ë²¡í„°ë¡œ í›ˆë ¨í•  **ì„¸ ê°€ì§€ íŠ¹ì„±**ì„ ì„ íƒí•˜ê³ , y ë²¡í„°ëŠ” `Country`ë¡œ í•œë‹¤.

   - `Seconds`,  `Latitude` , `Longitude`íŠ¹ì„±ì„ ì„ íƒí•˜ì—¬ ì…ë ¥í•˜ê³  ë°˜í™˜í•  êµ­ê°€ idë¥¼ ì–»ëŠ”ë‹¤.

   ```python
   from sklearn.model_selection import train_test_split
   
   # íŠ¹ì„± ì„ íƒ(ì´ˆ, ìœ„ë„, ê²½ë„)
   Selected_features = ['Seconds','Latitude','Longitude']
   
   X = ufos[Selected_features]
   y = ufos['Country']
   
   # í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ì…‹ìœ¼ë¡œ ë¶„ë¦¬
   X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
   ```

   <br>

2. **ë¡œì§€ìŠ¤í‹± íšŒê·€**ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•œë‹¤.

   ```python
   from sklearn.metrics import accuracy_score, classification_report
   from sklearn.linear_model import LogisticRegression
   model = LogisticRegression()
   model.fit(X_train, y_train)				# ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ëª¨ë¸ í›ˆë ¨
   predictions = model.predict(X_test)		# í›ˆë ¨ëœ ëª¨ë¸ì˜ ì •í™•ë„ ì˜ˆì¸¡
   
   print(classification_report(y_test, predictions))
   print('Predicted labels: ', predictions)
   print('Accuracy: ', accuracy_score(y_test, predictions))
   ```

   ```output
                 precision    recall  f1-score   support
   
              0       1.00      1.00      1.00        41
              1       0.83      0.23      0.36       250
              2       1.00      1.00      1.00         8
              3       1.00      1.00      1.00       131
              4       0.96      1.00      0.98      4743
   
       accuracy                           0.96      5173
      macro avg       0.96      0.85      0.87      5173
   weighted avg       0.96      0.96      0.95      5173
   
   Predicted labels:  [4 4 4 ... 3 4 4]
   Accuracy:  0.960371157935434
   ```

   `Country`ì™€ `Latitude/Longitude`ì˜ ìƒê´€ê´€ê³„ì¸ **ì •í™•ë„**ëŠ” ì•½ **96%**ì •ë„ë¡œ ë‚˜ì˜ì§€ ì•Šì€ ê²°ê³¼ì´ë‹¤.

   êµ¬ì¶•í•œ ëª¨ë¸ì€ `Latitude` ë° `Longitude`ì—ì„œ `Country`ë¥¼ ì¶”ë¡ í•  ìˆ˜ ìˆì„ ë§Œí¼ í˜ëª…ì ì¸ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ì •ì œí•˜ê³  ë‚´ë³´ë‚¸ ì›ë˜ì˜ ë°ì´í„°ë¥¼ í›ˆë ¨í•˜ê³  ì›¹ ì•±ì—ì„œ ì´ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ëŠ” ê²ƒì€ ì¢‹ì€ ì—°ìŠµì´ ë  ìˆ˜ ìˆë‹¤.

<br>

<br>

### Exercise - ëª¨ë¸ 'pickle'í•˜ê¸°

ì´ì œ, ëª¨ë¸ì„ *pickle*í•´ë³´ì.  *pickle*ì´ ì™„ë£Œë˜ë©´ **pickle ëª¨ë¸**ì„ ë¡œë“œí•˜ì—¬ *ì´ˆ, ìœ„ë„ ë° ê²½ë„* ê°’ì´ í¬í•¨ëœ **ìƒ˜í”Œ ë°ì´í„° ë°°ì—´**ì„ í…ŒìŠ¤íŠ¸í•œë‹¤.

```python
import pickle

# ëª¨ë¸ pickle(.pkl í™•ì¥ì) 
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

# pickle ëª¨ë¸ ë¡œë“œ ë° í…ŒìŠ¤íŠ¸
model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

```output
[1]
/usr/local/lib/python3.7/dist-packages/sklearn/base.py:451: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  "X does not have valid feature names, but"
```

ğŸš€ ëª¨ë¸ì´ Canadaë¥¼ ë‚˜íƒ€ë‚´ëŠ” '1'ì„ ë°˜í™˜í•˜ì˜€ë‹¤.

<br>

<br>

### Exercise - Flask app êµ¬ì¶•

ì´ì œ ëª¨ë¸ì„ í˜¸ì¶œí•˜ê³  ìœ ì‚¬í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” Flask ì•±ì„ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ, ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì‹œê°ì ìœ¼ë¡œ ë” ë§Œì¡±ìŠ¤ëŸ½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

1. ë¨¼ì € *ufo-model.pkl* íŒŒì¼ì´ ìˆëŠ” *notebook.ipynb* íŒŒì¼ ì˜†ì— ğŸ“**web-app** í´ë”ë¥¼ ë§Œë“ ë‹¤. 

   <img src="C:\Users\YeeEun\Desktop\ì˜Œ\Office\images\ì›¹ì•± êµ¬ì¶•\image-20220525013719250.png" alt="image-20220525013719250" style="zoom:80%;" />

   <br>

2. ğŸ“*web-app* í´ë”ì— ğŸ“*templates*í´ë”ì™€ ğŸ“*css*í´ë”ë¥¼ í¬í•¨í•˜ëŠ” ğŸ“*static*í´ë”ë¥¼ ë§Œë“ ë‹¤. 

   <img src="C:\Users\YeeEun\Desktop\ì˜Œ\Office\images\ì›¹ì•± êµ¬ì¶•\image-20220525013850581.png" alt="image-20220525013850581" style="zoom:80%;" />

   <br>

3. ğŸ“*web-app* í´ë”ì—  *requirements.txt* íŒŒì¼ì„ ë§Œë“ ë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ ì•±ì˜ *package.json*ì²˜ëŸ¼, ì´ íŒŒì¼ì€ ì•±ì— í•„ìš”í•œ **ì˜ì¡´ì„±**ì„ ë‚˜ì—´í•œë‹¤. *requirements.txt*ì— ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•œë‹¤.

   ```
   scikit-learn
   pandas
   numpy
   flask
   ```

   <br>

4. ì´ì œ í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•˜ê³  ğŸ“*web-app*ìœ¼ë¡œ ì´ë™í•´ì„œ **íŒŒì¼ì„ ë™ì‘** ì‹œí‚¨ë‹¤.

   ```
   cd web-app
   ```

   <br>

5. í„°ë¯¸ë„ì—ì„œ `pip install` ëª…ë ¹ì–´ë¡œ  *requirements.txt*ì— ìˆëŠ” **ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜**í•œë‹¤.

   ```
   pip install -r requirements.txt
   ```

   <br>

6. ì•±ì„ ì™„ì„±í•˜ê¸° ìœ„í•´ 3ê°œì˜ íŒŒì¼ì„ ë” ë§Œë“ ë‹¤.

   - ì´ ê²½ë¡œì— `app.py`ë¥¼ ìƒì„±í•œë‹¤.

   - ğŸ“‚*templates* ë””ë ‰í„°ë¦¬ì— *index.html*ì„ ìƒì„±í•œë‹¤.

   - ğŸ“‚*static/css* ë””ë ‰í„°ë¦¬ì— *style.css*ë¥¼ ìƒì„±í•œë‹¤.

     <img src="C:\Users\YeeEun\Desktop\ì˜Œ\Office\images\ì›¹ì•± êµ¬ì¶•\image-20220525014252521.png" alt="image-20220525014252521" style="zoom:80%;" />

     <br>

7. *style.css* íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•œë‹¤.

   ```css
   body {
   	width: 100%;
   	height: 100%;
   	font-family: 'Helvetica';
   	background: black;
   	color: #fff;
   	text-align: center;
   	letter-spacing: 1.4px;
   	font-size: 30px;
   }
   
   input {
   	min-width: 150px;
   }
   
   .grid {
   	width: 300px;
   	border: 1px solid #2d2d2d;
   	display: grid;
   	justify-content: center;
   	margin: 20px auto;
   }
   
   .box {
   	color: #fff;
   	background: #2d2d2d;
   	padding: 12px;
   	display: inline-block;
   }
   ```

   <br>

8. *index.html* íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•œë‹¤.

   ```html
   <!DOCTYPE html>
   <html>
     <head>
       <meta charset="UTF-8">
       <title>ğŸ›¸ UFO ëª©ê²© ì˜ˆì¸¡í•˜ê¸° ğŸ‘½</title>
       <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
     </head>
   
     <body>
       <div class="grid">
   
         <div class="box">
   
           <p>'ì´ˆ', 'ìœ„ë„', 'ê²½ë„'ë¥¼ ë³´ì•˜ì„ ë•Œ, ì–´ëŠ ë‚˜ë¼ê°€ UFOë¥¼ ë´¤ë‹¤ê³  ë³´ê³ í–ˆì„ ê²ƒ ê°™ë‚˜ìš”?</p>
   
           <form action="{{ url_for('predict')}}" method="post">
             <input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
             <input type="text" name="latitude" placeholder="Latitude" required="required" />
             <input type="text" name="longitude" placeholder="Longitude" required="required" />
             <button type="submit" class="btn">UFO ëª©ê²©ì„ ë³´ê³ í•œ êµ­ê°€ ì˜ˆì¸¡</button>
           </form>
   
           <p>{{ prediction_text }}</p>
   
         </div>
   
       </div>
   
     </body>
   </html>
   ```

   <br>

9. ëª¨ë¸ì˜ ì†Œë¹„ì™€ ì˜ˆì¸¡ í‘œì‹œë¥¼ ì£¼ë„í•˜ëŠ” python íŒŒì¼ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•´ `app.py`ì— ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•œë‹¤.

   ```python
   import numpy as np
   from flask import Flask, request, render_template
   import pickle
   
   app = Flask(__name__)
   
   model = pickle.load(open("./ufo-model.pkl", "rb"))
   
   
   @app.route("/")
   def home():
       return render_template("index.html")
   
   
   @app.route("/predict", methods=["POST"])
   def predict():
   
       int_features = [int(x) for x in request.form.values()]
       final_features = [np.array(int_features)]
       prediction = model.predict(final_features)
   
       output = prediction[0]
   
       countries = ["Australia", "Canada", "Germany", "UK", "US"]
   
       return render_template(
           "index.html", prediction_text="ì˜ˆì¸¡ êµ­ê°€: {}".format(countries[output])
       )
   
   
   if __name__ == "__main__":
       app.run(debug=True)
   ```

   > ğŸ’¡ Tip:  [`debug=True`](https://www.askpython.com/python-modules/flask/flask-debug-mode)ë¥¼ ì¶”ê°€í•  ë•Œ, Flaskë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì•±ì„ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆì—ëŠ” ì„œë²„ë¥¼ ì¬ì‹œì‘í•  í•„ìš” ì—†ì´ ì•±ì— ëŒ€í•œ **ë³€ê²½ì‚¬í•­ì´ ì¦‰ì‹œ ë°˜ì˜**ëœë‹¤. 
   >
   > ë”°ë¼ì„œ ì‹¤ì œë¡œ ì¶œì‹œí•˜ëŠ” ì•±ì—ì„œëŠ” ì´ ëª¨ë“œë¥¼ í™œì„±í™”í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼ í•œë‹¤.

   ë§Œì•½ `python app.py` ë˜ëŠ” `python3 app.py`ì„ ì‹¤í–‰í•œë‹¤ë©´, ì›¹ ì„œë²„ëŠ” ë¡œì»¬ì—ì„œ ì‹œì‘ë˜ê³ , UFOê°€ ì–´ë””ì„œ ë°œê²¬ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•œ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì„ ì–»ê¸° ìœ„í•´ ì§§ì€ ì–‘ì‹ì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

   

   ğŸŒº  `app.py` ì‚´í´ë³´ê¸°

   1. ì¢…ì†ì„±ì´ ë¡œë“œë˜ê³  ì•±ì´ ì‹œì‘ëœë‹¤.

   2. ê·¸ëŸ° ë‹¤ìŒ ëª¨ë¸ì„ ê°€ì ¸ì˜¨ë‹¤.

   3. ê·¸ëŸ° ë‹¤ìŒ *index.html* ì´ í™ˆ ê²½ë¡œì— ë Œë”ë§ëœë‹¤.

      <img src="C:\Users\YeeEun\Desktop\ì˜Œ\Office\images\ì›¹ì•± êµ¬ì¶•\image-20220525015332486.png" alt="image-20220525015332486" style="zoom: 67%;" />

   <br>

   ğŸŒº  `/predict` ê²½ë¡œì—ì„œ ì–‘ì‹ì´ ê²Œì‹œë  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ëª‡ ê°€ì§€ ì¼ì´ ë°œìƒí•œë‹¤.

   1. í¼ ë³€ìˆ˜ê°€ ìˆ˜ì§‘ë˜ê³  **numpy array**ë¡œ ë³€í™˜ëœë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì´ëŸ¬í•œ ì •ë³´ê°€ **ëª¨ë¸ë¡œ ì „ì†¡**ë˜ê³  **ì˜ˆì¸¡ì´ ë°˜í™˜**ëœë‹¤.
   2. í‘œì‹œí•  êµ­ê°€ëŠ” ì˜ˆìƒ êµ­ê°€ ì½”ë“œì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í…ìŠ¤íŠ¸ë¡œ ë‹¤ì‹œ ë Œë”ë§ë˜ë©°, ì´ ê°’ì€ í…œí”Œë¦¿ì—ì„œ ë Œë”ë§ë˜ë„ë¡ *index.html*ë¡œ ë‹¤ì‹œ ì „ì†¡ëœë‹¤.

   <br>

   <br>

   ### ì›¹ ì•± êµ¬ì¶• ê²°ê³¼

   `app.py`ë¥¼ ì‹¤í–‰í•œ ê²°ê³¼ì—ì„œ ë§ˆì§€ë§‰ ì¤„ì— í‘œì‹œëœ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ë©´ êµ¬ì¶•ëœ ì›¹ ì•±ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

   ì´ ë°ì´í„°ì—ì„œëŠ” ì˜ˆì¸¡ì„ ìœ„í•´ **ì„¸ ê°œì˜ ë°ì´í„°**ë¥¼ ì…ë ¥í•´ì•¼í•œë‹¤.

   <img src="C:\Users\YeeEun\Desktop\ì˜Œ\Office\images\ì›¹ì•± êµ¬ì¶•\image-20220525025155032.png" alt="image-20220525025155032" style="zoom: 67%;" />

   

   ìœ„ì—ì„œ ì˜ˆì¸¡í•œ ëŒ€ë¡œ ê°’ì´ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ [50, 44, -12]ë¥¼ ì…ë ¥í•´ë³´ë©´ ì˜ˆì¸¡ êµ­ê°€ê°€ Canadaë¡œ ê²°ê³¼ê°€ ë˜‘ê°™ì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

   <img src="C:\Users\YeeEun\Desktop\ì˜Œ\Office\images\ì›¹ì•± êµ¬ì¶•\image-20220525025447746.png" alt="image-20220525025447746" style="zoom:67%;" />

   <br>

   > *Flaskì™€ í”¼í´ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ë¹„êµì  ê°„ë‹¨í•˜ë‹¤.* 
   >
   > *ê°€ì¥ ì–´ë ¤ìš´ ê²ƒì€ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ëª¨ë¸ë¡œ ì „ì†¡í•´ì•¼ í•˜ëŠ” ë°ì´í„°ê°€ ì–´ë–¤ í˜•íƒœì¸ì§€ ì´í•´í•˜ëŠ” ê²ƒì´ë‹¤.*
   >
   > *ì´ê²ƒì€ **ëª¨ë¸ì´ ì–´ë–»ê²Œ í›ˆë ¨ë˜ëŠ”ì§€**ì— ë‹¬ë ¤ ìˆë‹¤.*

<br>

<br>

<br>

ğŸš€ *ìœ„ì˜ ëª¨ë“  ë‚´ìš©ì€ [ML-For-Beginners](https://github.com/codingalzi/ML-For-Beginners/blob/main/3-Web-App/1-Web-App/README.md) ë°”íƒ•ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*





