---
layout: single
title:  "[ë¨¸ì‹ ëŸ¬ë‹] Getting started with classification"
categories: 
  - Machine_Learning
tag: [python, blog, machinelearning]
toc: true
use_math: true
author_profile: false
sidebar:
  nav: "docs"
---

# ì§€ì—­ ì£¼ì œ: Delicious Asian and Indian Cuisines 

---

ê³ ì „ì ì¸ ë¨¸ì‹ ëŸ¬ë‹ì˜ ê¸°ë³¸ ì´ˆì ì¸ **ë¶„ë¥˜**ì— ëŒ€í•´ ì•Œì•„ë³´ì



## 1. ë¶„ë¥˜ ì†Œê°œ

---

 ì•„ì‹œì•„ì™€ ì¸ë„ì˜ ëª¨ë“  í›Œë¥­í•œ ìš”ë¦¬ì— ëŒ€í•œ ë°ì´í„°ì…‹ì— ë‹¤ì–‘í•œ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤.



ë¶„ë¥˜ëŠ” íšŒê·€ ê¸°ë²•ê³¼ ë§ì€ ê³µí†µì ì´ ìˆëŠ” ì§€ë„ í•™ìŠµì˜ í•œ í˜•íƒœì´ë‹¤. ë¨¸ì‹ ëŸ¬ë‹ì´ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ê°’ì´ë‚˜ ì´ë¦„ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë¼ë©´, ë¶„ë¥˜ëŠ” ì¼ë°˜ì ìœ¼ë¡œ **ì´ì§„ ë¶„ë¥˜**ì™€ **ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜**ì˜ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ë‰œë‹¤.



- ì„ í˜• íšŒê·€ ë¶„ì„ì„ ì‚¬ìš©í•˜ë©´ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì˜ˆì¸¡í•˜ê³  í•´ë‹¹ ì„ ê³¼ ê´€ë ¨í•˜ì—¬ ìƒˆ ë°ì´í„° ì ì´ í¬í•¨ë  ìœ„ì¹˜ë¥¼ ì •í™•í•˜ê²Œ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, 9ì›”ê³¼ 12ì›”ì— í˜¸ë°•ì˜ ê°€ê²©ì´ ì–¼ë§ˆì¸ì§€ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤.

- ë¡œì§€ìŠ¤í‹± íšŒê·€ ë¶„ì„ì„ í†µí•´ "ì´ì§„ ë²”ì£¼"ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ ê°€ê²©ëŒ€ì—ì„œ í˜¸ë°•ì€ ì£¼í™©ìƒ‰ì¸ê°€, ì•„ë‹Œê°€?ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.

  

ë¶„ë¥˜ëŠ” ë‹¤ì–‘í•œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì ì˜ ë ˆì´ë¸”ì´ë‚˜ í´ë˜ìŠ¤ë¥¼ ê²°ì •í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•ì„ ê²°ì •í•œë‹¤. ì´ ìš”ë¦¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ **ì¬ë£Œ ê·¸ë£¹**ì„ ê´€ì°°í•¨ìœ¼ë¡œì¨ **ìŒì‹ì˜ ìœ ë˜**ë¥¼ ê²°ì •í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì.




### ì†Œê°œ

---

ë¶„ë¥˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ì—°êµ¬ìì™€ ë°ì´í„° ê³¼í•™ìì˜ ê¸°ë³¸ í™œë™ ì¤‘ í•˜ë‚˜ì´ë‹¤. ì´ì§„ ê°’ì˜ ê¸°ë³¸ ë¶„ë¥˜("ì´ ì´ë©”ì¼ì€ ìŠ¤íŒ¸ì…ë‹ˆê¹Œ?")ì—ì„œ ì»´í“¨í„° ë¹„ì „ì„ ì‚¬ìš©í•œ ë³µì¡í•œ ì´ë¯¸ì§€ ë¶„ë¥˜ ë° ë¶„í• ì— ì´ë¥´ê¸°ê¹Œì§€ ë°ì´í„°ë¥¼ í´ë˜ìŠ¤ë¡œ ì •ë ¬í•˜ê³  ê·¸ì— ëŒ€í•œ ì§ˆë¬¸ì„ í•  ìˆ˜ ìˆëŠ” ê²ƒì€ í•­ìƒ ìœ ìš©í•˜ë‹¤.

ë³´ë‹¤ ê³¼í•™ì ì¸ ë°©ë²•ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´, ë¶„ë¥˜ ë°©ë²•ì—ì„œëŠ” ì…ë ¥ ë³€ìˆ˜ì™€ ì¶œë ¥ ë³€ìˆ˜ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ë§¤í•‘í•  ìˆ˜ ìˆëŠ” ì˜ˆì¸¡ ëª¨ë¸ì„ ë§Œë“ ë‹¤.

ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  ì‹œê°í™”í•˜ê³  ë¨¸ì‹ ëŸ¬ë‹ ì‘ì—…ì— ëŒ€ë¹„í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘í•˜ê¸° ì „ì—, ë¨¸ì‹ ëŸ¬ë‹ì„ í™œìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì— ëŒ€í•´ ì¡°ê¸ˆ ì•Œì•„ë³´ì.

í†µê³„ì—ì„œ íŒŒìƒëœ ê³ ì „ì ì¸ ë¨¸ì‹ ëŸ¬ë‹ì„ ì‚¬ìš©í•œ ë¶„ë¥˜ëŠ” `smoker`,  `weight`,  `age`ì™€ ê°™ì€ íŠ¹ì„±ì„ ì‚¬ìš©í•˜ì—¬ ***X*ì§ˆí™˜ì˜ ë°œë³‘ ê°€ëŠ¥ì„±**ì„ ê²°ì •í•œë‹¤. íšŒê·€ì™€ ìœ ì‚¬í•œ ì§€ë„ í•™ìŠµ ê¸°ë²•ìœ¼ë¡œ, ë°ì´í„°ì— ë ˆì´ë¸”ì´ ì§€ì •ë˜ê³  ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì€ ì´ëŸ¬í•œ ë ˆì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤(ë˜ëŠ” 'íŠ¹ì„±')ë¥¼ ë¶„ë¥˜í•˜ê³  ì˜ˆì¸¡í•˜ì—¬ ê·¸ë£¹ ë˜ëŠ” ê²°ê³¼ì— í• ë‹¹í•œë‹¤.

âœ… ìš”ë¦¬ì— ëŒ€í•œ ë°ì´í„° ì„¸íŠ¸ë¥¼ ìƒê°í•´ë³´ì. ë‹¤ì¤‘ í´ë˜ìŠ¤ ëª¨ë¸ì´ ëŒ€ë‹µí•  ìˆ˜ ìˆëŠ” ê²ƒì€ ë¬´ì—‡ì¼ê¹Œ? ì´ì§„ ëª¨ë¸ì€ ë¬´ì—‡ì„ ë‹µí•  ìˆ˜ ìˆì„ê¹Œ? ë§Œì•½ ì£¼ì–´ì§„ ìš”ë¦¬ê°€ í˜ëˆ„ê·¸ë¦­ì„ ì‚¬ìš©í•  ê°€ëŠ¥ì„±ì´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ê²°ì •í•˜ê¸°ë¥¼ ì›í•œë‹¤ë©´? ë§Œì•½ ìŠ¤íƒ€ ì•„ë‹ˆìŠ¤, ì•„í‹°ì´ˆí¬, ì½œë¦¬í”Œë¼ì›Œ, ê·¸ë¦¬ê³  ê³ ì¶”ëƒ‰ì´ê°€ ê°€ë“í•œ ì‹ë£Œí’ˆ ë´‰ì§€ë¥¼ ì„ ë¬¼ë¡œ ë°›ëŠ”ë‹¤ë©´, ì „í˜•ì ì¸ ì¸ë„ ìš”ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì„ê¹Œ?



### Classifier

---

ìš°ë¦¬ê°€ ì´ ìš”ë¦¬ ë°ì´í„°ì…‹ì— ëŒ€í•´ ë¬»ê³  ì‹¶ì€ ê²ƒì€  ëª‡ ê°€ì§€ ì ì¬ì ì¸ êµ­ê°€ ìš”ë¦¬ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ê¸° ë•Œë¬¸ì— ì‚¬ì‹¤ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¬¸ì œì´ë‹¤. ì„±ë¶„ ë°°ì¹˜ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ì´ ë§ì€ í´ë˜ìŠ¤ ì¤‘ ì–´ë–¤ ë°ì´í„°ê°€ ì í•©í• ê¹Œ?

Scikit-learnì€ í•´ê²°í•˜ë ¤ëŠ” ë¬¸ì œì˜ ì¢…ë¥˜ì— ë”°ë¼ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•œë‹¤. ì´ëŸ¬í•œ ì•Œê³ ë¦¬ì¦˜ ì¤‘ ëª‡ ê°€ì§€ì— ëŒ€í•´ ê³µë¶€í•´ë³´ì.



### ë°ì´í„° êµ¬í•˜ê¸°

---

ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ê¸° ì „ì— ê°€ì¥ ë¨¼ì € í•´ì•¼ í•  ì¼ì€ ë°ì´í„°ë¥¼ ì •ì œí•˜ê³  ê· í˜•ì„ ë§ì¶”ì–´ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ì–»ëŠ” ê²ƒì´ë‹¤. ì´ í´ë”ì˜ ë£¨íŠ¸ì— ìˆëŠ” ë¹ˆ notebook.ipynb íŒŒì¼ë¡œ ì‹œì‘í•œë‹¤.

ê°€ì¥ ë¨¼ì € ì„¤ì¹˜í•´ì•¼ í•  ê²ƒì€ `imblearn`ì´ë‹¤. ì´ê²ƒì€ ë°ì´í„°ì˜ ê· í˜•ì„ ë” ì˜ ì¡°ì •í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” Scikit-learn íŒ¨í‚¤ì§€ì´ë‹¤.



1. `imblearn`ì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ `pip install`ì„ ì‹¤í–‰í•œë‹¤.

   ```python
   pip install imblearn
   ```

   

2. ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì‹œê°í™”í•˜ëŠ” ë° í•„ìš”í•œ íŒ¨í‚¤ì§€ì™€ `imblearn`ì˜ `SMOTE`ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.

   ```python
   import pandas as pd
   import matplotlib.pyplot as plt
   import matplotlib as mpl
   import numpy as np
   from imblearn.over_sampling import SMOTE
   ```

   ì´ì œ ë‹¤ìŒì— ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ ì½ë„ë¡ ì„¤ì •ë˜ì—ˆë‹¤.

   

3. ë‹¤ìŒ ì‘ì—…ì€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì´ë‹¤.

   ```python
   datapath = "https://raw.githubusercontent.com/codingalzi/ML-For-Beginners/main/4-Classification/data/"
   df  = pd.read_csv(datapath+"cuisines.csv")
   ```

   `read_csv`ë¥¼ ì´ìš©í•˜ì—¬ csvíŒŒì¼ì¸ *cuisines.csv*ì˜ ë‚´ìš©ì„ ì½ê³  ë³€ìˆ˜ `df`ì— í• ë‹¹í•œë‹¤.

   

4. ë°ì´í„°ì˜ ëª¨ì–‘ì„ í™•ì¸í•´ë³´ì.

   ```python
   df.head()	# ì²« 5í–‰ ì¶œë ¥
   ```

   | index | Unnamed: 0 | cuisine | almond | angelica | anise | anise\_seed | apple | apple\_brandy | apricot | armagnac | artemisia | artichoke | asparagus | avocado | bacon | baked\_potato | balm | banana | barley | bartlett\_pear |
   | :---: | :--------- | :-----: | ------ | -------- | ----- | ----------- | ----- | ------------- | ------- | -------- | --------- | --------- | --------- | ------- | ----- | ------------- | ---- | ------ | ------ | :------------- |
   |   0   | 65         | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   1   | 66         | indian  | 1      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   2   | 67         | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   3   | 68         | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   4   | 69         | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |

   

5. `info()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ì´ ë°ì´í„°ì˜ ì •ë³´ë¥¼ ì•Œì•„ë³´ì.

   ```python
   df.info()
   ```

   <span style="color:#a3a3a3;font-size:small;display:block;">

   <class 'pandas.core.frame.DataFrame'>
   RangeIndex: 2448 entries, 0 to 2447
   Columns: 385 entries, Unnamed: 0 to zucchini
   dtypes: int64(384), object(1)
   memory usage: 7.2+ MB	

   </span>



### ë°ì´í„° íƒìƒ‰ - cuisines

---

ê° ìš”ë¦¬ì˜ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ì•Œì•„ë³´ì.



1. `barsh()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ë°ì´í„°ë¥¼ ë°” í˜•íƒœë¡œ ì‹œê°í™”í•œë‹¤.

   ```python
   df.cuisine.value_counts().plot.barh()
   ```

   ![cuisine data distribution](https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/1-Introduction/images/cuisine-dist.png)

   í•œì •ëœ ìˆ˜ì˜ ìš”ë¦¬ê°€ ìˆì§€ë§Œ, ë°ì´í„°ì˜ ë¶„í¬ê°€ ê³ ë¥´ì§€ ì•Šë‹¤. ì´ë¥¼ ê³ ì¹˜ê¸° ì „ì— ì¡°ê¸ˆ ë” ì‚´í´ë³´ì.

   

2. ê° ìš”ë¦¬ê°€ ì–¼ë§ˆë‚˜ ë§ì€ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ê³  ì¶œë ¥í•œë‹¤.

   ```python
   thai_df = df[(df.cuisine == "thai")]
   japanese_df = df[(df.cuisine == "japanese")]
   chinese_df = df[(df.cuisine == "chinese")]
   indian_df = df[(df.cuisine == "indian")]
   korean_df = df[(df.cuisine == "korean")]
   
   print(f'thai df: {thai_df.shape}')
   print(f'japanese df: {japanese_df.shape}')
   print(f'chinese df: {chinese_df.shape}')
   print(f'indian df: {indian_df.shape}')
   print(f'korean df: {korean_df.shape}')
   ```

   <span style="color:#a3a3a3;font-size:small;display:block;">

   thai df: (289, 385)
   japanese df: (320, 385)
   chinese df: (442, 385)
   indian df: (598, 385)
   korean df: (799, 385) 

   </span>



### ë°ì´í„° ì •ì œ ë° ì‹œê°í™” - ì‹ì¬ë£Œ ì•Œì•„ë³´ê¸°

---

ì´ì œ ë°ì´í„°ë¥¼ ë” ê¹Šì´ íŒŒê³ ë“¤ì–´ ê° ìš”ë¦¬ì˜ ëŒ€í‘œì ì¸ ì‹ì¬ë£Œê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³´ì. ìš°ì„  ìš”ë¦¬ë¥¼ êµ¬ë¶„í•˜ëŠ” ë° í˜¼ë€ì„ ì¼ìœ¼í‚¤ëŠ” **ë°˜ë³µì ì¸ ë°ì´í„°ë¥¼ ì œê±°**í•´ì•¼ í•˜ëŠ”ë°, ì´ ë¬¸ì œì— ëŒ€í•´ ì•Œì•„ë³´ë„ë¡ í•˜ì.



1. íŒŒì´ì¬ì—ì„œ `create_ingredient()` í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì‹ì¬ë£Œ ë°ì´í„° í”„ë ˆì„ì„ ë§Œë“ ë‹¤. ì´ í•¨ìˆ˜ëŠ” ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ” ì—´ì„ ì œê±°í•˜ê³  ì„±ë¶„ì„ ê°œìˆ˜ì— ë”°ë¼ ì •ë ¬í•œë‹¤.

   ```python
   def create_ingredient_df(df):
       ingredient_df = df.T.drop(['cuisine','Unnamed: 0']).sum(axis=1).to_frame('value')	# í•„ìš” ì—†ëŠ” ì—´ ì œê±°
       ingredient_df = ingredient_df[(ingredient_df.T != 0).any()]
       ingredient_df = ingredient_df.sort_values(by='value', ascending=False,
       inplace=False)
       return ingredient_df
   ```

   ì´ì œ ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ë¦¬ë³„ë¡œ ê°€ì¥ ì¸ê¸° ìˆëŠ” 10ëŒ€ ì‹ì¬ë£Œì— ëŒ€í•œ ì•„ì´ë””ì–´ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.

   

2. `create_ingredient()`ë¥¼ í˜¸ì¶œí•˜ê³  `barch()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ì‹œê°í™”í•œë‹¤.

   ```python
   # íƒœêµ­ ìŒì‹ì˜ 10ëŒ€ ì‹ì¬ë£Œ
   thai_ingredient_df = create_ingredient_df(thai_df)
   thai_ingredient_df.head(10).plot.barh()
   ```

   ![thai](https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/1-Introduction/images/thai.png)

   

   ```python
   # ì¼ë³¸ ìŒì‹ì˜ 10ëŒ€ ì‹ì¬ë£Œ
   japanese_ingredient_df = create_ingredient_df(japanese_df)
   japanese_ingredient_df.head(10).plot.barh()
   ```

   ![japanese](https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/1-Introduction/images/japanese.png)

   

   ```python
   # ì¤‘êµ­ ìŒì‹ì˜ 10ëŒ€ ì‹ì¬ë£Œ
   chinese_ingredient_df = create_ingredient_df(chinese_df)
   chinese_ingredient_df.head(10).plot.barh()
   ```

   ![chinese](https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/1-Introduction/images/chinese.png)

   

   ```python
   # ì¸ë„ ìŒì‹ì˜ 10ëŒ€ ì‹ì¬ë£Œ
   indian_ingredient_df = create_ingredient_df(indian_df)
   indian_ingredient_df.head(10).plot.barh()
   ```

   ![indian](https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/1-Introduction/images/indian.png)

   

   ```python
   # í•œêµ­ ìŒì‹ì˜ 10ëŒ€ ì‹ì¬ë£Œ
   korean_ingredient_df = create_ingredient_df(korean_df)
   korean_ingredient_df.head(10).plot.barh()
   ```

   ![korean](https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/1-Introduction/images/korean.png)

   

3. `drop()`ì„ í˜¸ì¶œí•˜ì—¬ ìš”ë¦¬ë“¤ì„ êµ¬ë¶„í•˜ëŠ”ë° í˜¼ë€ì„ ì¼ìœ¼í‚¤ëŠ” ê°€ì¥ í”í•œ ì¬ë£Œë“¤(ìŒ€, ë§ˆëŠ˜, ìƒê°•)ì„ ì œê±°í•œë‹¤.

   ```python
   feature_df= df.drop(['cuisine','Unnamed: 0','rice','garlic','ginger'], axis=1)
   labels_df = df.cuisine #.unique()
   feature_df.head()
   ```

   | index | almond | angelica | anise | anise\_seed | apple | apple\_brandy | apricot | armagnac | artemisia | artichoke | asparagus | avocado | bacon | baked\_potato | balm | banana | barley | bartlett\_pear | basil | bay  |
   | :---: | ------ | -------- | ----- | ----------- | ----- | ------------- | ------- | -------- | --------- | --------- | --------- | ------- | ----- | ------------- | ---- | ------ | ------ | -------------- | ----- | ---- |
   |   0   | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   |   1   | 1      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   |   2   | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   |   3   | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   |   4   | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |





### ë°ì´í„°ì…‹ ê· í˜• ë§ì¶”ê¸°

---

ë°ì´í„°ë¥¼ ì •ì œí–ˆìœ¼ë‹ˆ ì´ì œ SMOTE (Synthetic Minority Over-sampling Techniqu)ë¥¼ ì‚¬ìš©í•˜ì—¬ ê· í˜•ì„ ë§ì¶˜ë‹¤.



1. `fit_resample()`ì„ í˜¸ì¶œí•œë‹¤. ì´ê²ƒì€ ìƒˆë¡œìš´ ìƒ˜í”Œì„ ìƒì„±í•˜ì—¬ ì…ë ¥í•œë‹¤.

   ```python
   oversample = SMOTE()
   transformed_feature_df, transformed_label_df = oversample.fit_resample(feature_df, labels_df)
   ```

   ë°ì´í„°ì˜ ê· í˜•ì„ ìœ ì§€í•˜ë©´ì„œ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•  ë•Œ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. ì´ì§„ ë¶„ë¥˜ì— ëŒ€í•´ ìƒê°í•´ ë³´ì. ëŒ€ë¶€ë¶„ì˜ ë°ì´í„°ê°€ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì¸ ê²½ìš°, ë‹¨ì§€ ê·¸ í´ë˜ìŠ¤ì— ë” ë§ì€ ë°ì´í„°ê°€ ìˆê¸° ë•Œë¬¸ì— ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ë” ìì£¼ ì˜ˆì¸¡í•œë‹¤. ë°ì´í„°ì˜ ê· í˜•ì„ ë§ì¶”ë ¤ë©´ **í¸í–¥ëœ ë°ì´í„°**ê°€ í•„ìš”í•˜ë©° ì´ê²ƒì€ ì´ëŸ¬í•œ ë¶ˆê· í˜•ì„ ì œê±°í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤.

   

2. ê° ì‹ì¬ë£Œì˜ ë ˆì´ë¸” ìˆ˜ë¥¼ í™•ì¸í•´ ë³´ì.

   ```python
   print(f'new label count: {transformed_label_df.value_counts()}')
   print(f'old label count: {df.cuisine.value_counts()}')
   ```

   <span style="color:#a3a3a3;font-size:small;display:block;">

   new label count: korean      799
   chinese     799
   indian      799
   japanese    799
   thai        799
   Name: cuisine, dtype: int64
   old label count: korean      799
   indian      598
   chinese     442
   japanese    320
   thai        289
   Name: cuisine, dtype: int64

   </span>

   ë°ì´í„°ê°€ ì˜ ì •ì œë˜ì—ˆê³  ê· í˜•ì´ ë§ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

   

3. ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ë ˆì´ë¸”ê³¼ íŠ¹ì„±ì„ í¬í•¨í•˜ëŠ” ê· í˜• ì¡íŒ ë°ì´í„°ë¥¼ íŒŒì¼ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆëŠ” ìƒˆë¡œìš´ ë°ì´í„° í”„ë ˆì„ì— ì €ì¥í•˜ëŠ” ê²ƒì´ë‹¤.

   ```python
   transformed_df = pd.concat([transformed_label_df,transformed_feature_df],axis=1, join='outer')
   ```

   

4. `transformed_df.head()`ì™€ `transformed_df.info()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ í•œë²ˆ ë” í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë‹¤ìŒì— ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì´ ë°ì´í„°ì˜ ë³µì‚¬ë³¸ì„ ì €ì¥í•  ìˆ˜ ìˆë‹¤.

   ```python
   transformed_df.head()
   transformed_df.info()
   transformed_df.to_csv(datapath + "cleaned_cuisines.csv")	# íŒŒì¼ì„ ì €ì¥í•  ê²½ë¡œ ì§€ì •
   ```

   



## 2. ìš”ë¦¬ ë¶„ë¥˜ê¸° 1

---

ì €ì¥í–ˆë˜ ëª¨ë“  ìŒì‹ì— ëŒ€í•œ ê· í˜• ì¡íŒ ì •ì œ ë°ì´í„°ë¥¼ í¬í•¨í•œ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•œë‹¤.

ì´ ë°ì´í„°ì…‹ì„ ë‹¤ì–‘í•œ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ **ì‹ì¬ë£Œ ê·¸ë£¹ì„ ê¸°ë°˜ìœ¼ë¡œ íŠ¹ì • êµ­ê°€ ìŒì‹ì„ ì˜ˆì¸¡**í•  ìˆ˜ ìˆë‹¤. ë¶„ë¥˜ ì‘ì—…ì— ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•  ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ ë°©ë²•ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ì.



### í•œ êµ­ê°€ ìš”ë¦¬ ì˜ˆì¸¡

---

1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

   ```python
   cuisines_df = pd.read_csv(datapath+"cleaned_cuisines.csv")
   	# transformed_df
   cuisines_df.head()
   ```

   | index | Unnamed: 0 | cuisine | almond | angelica | anise | anise\_seed | apple | apple\_brandy | apricot | armagnac | artemisia | artichoke | asparagus | avocado | bacon | baked\_potato | balm | banana | barley | bartlett\_pear |
   | :---: | ---------: | ------- | ------ | -------- | ----- | ----------- | ----- | ------------- | ------- | -------- | --------- | --------- | --------- | ------- | ----- | ------------- | ---- | ------ | ------ | -------------- |
   |   0   |          0 | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   1   |          1 | indian  | 1      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   2   |          2 | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   3   |          3 | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   |   4   |          4 | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |

    

   ```python
   # ëª‡ ê°€ì§€ ë¼ì´ë¸ŒëŸ¬ë¦¬ import
   from sklearn.linear_model import LogisticRegression	
   from sklearn.model_selection import train_test_split, cross_val_score
   from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report, precision_recall_curve
   from sklearn.svm import SVC
   ```

   

2. í›ˆë ¨ì„ ìœ„í•´ X ì™€ yë¥¼ ë‘ ê°œì˜ ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë‚˜ëˆˆë‹¤. `cuisine`ì€ ë ˆì´ë¸” ë°ì´í„° í”„ë ˆì„ì´ ë  ìˆ˜ ìˆë‹¤.

   ```python
   cuisines_label_df = cuisines_df['cuisine']
   cuisines_label_df.head()
   ```

   <span style="color:#a3a3a3;font-size:small;display:block;">

   0    indian
   1    indian
   2    indian
   3    indian
   4    indian
   Name: cuisine, dtype: object

   </span>

3. `drop()`ì„ í˜¸ì¶œí•˜ì—¬ `Unnamed: 0` ì—´ê³¼ `cuisine`ì—´ì„ ì œê±°í•˜ê³  ë‚˜ë¨¸ì§€ ë°ì´í„°ë¥¼ í›ˆë ¨ ê°€ëŠ¥í•œ íŠ¹ì„±ìœ¼ë¡œ ì €ì¥í•œë‹¤.  

   ```python
   cuisines_feature_df = cuisines_df.drop(['Unnamed: 0', 'cuisine'], axis=1)
   cuisines_feature_df.head()
   ```

   | index | almond | angelica | anise | anise\_seed | apple | apple\_brandy | apricot | armagnac | artemisia | artichoke | asparagus | avocado | bacon | baked\_potato | balm | banana | barley | bartlett\_pear | basil | bay  |
   | ----- | ------ | -------- | ----- | ----------- | ----- | ------------- | ------- | -------- | --------- | --------- | --------- | ------- | ----- | ------------- | ---- | ------ | ------ | -------------- | ----- | ---- |
   | 0     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 1     | 1      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 2     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 3     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 4     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |

### 

### ë¶„ë¥˜ê¸° ì„ íƒ

---

ì´ì œ ë°ì´í„°ê°€ ì •ì œë˜ì—ˆê³  í›ˆë ¨í•  ì¤€ë¹„ê°€ ë˜ì—ˆìœ¼ë¯€ë¡œ ì‘ì—…ì— ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ì„ ê²°ì •í•´ì•¼ í•œë‹¤.

Scikit-learnì€ ë¶„ë¥˜ë¥¼ **ì§€ë„í•™ìŠµ**ìœ¼ë¡œ ë¶„ë¥˜í•˜ë©°, ì´ ì¹´í…Œê³ ë¦¬ì—ì„œ ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤. ë‹¤ìŒ ë°©ë²•ì—ëŠ” ëª¨ë‘ ë¶„ë¥˜ ê¸°ë²•ì´ í¬í•¨ëœë‹¤.

- ì„ í˜• ëª¨ë¸(Linear Models)
- ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ (Support Vector Machines, SVM)
- í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(Stochastic Gradient Descent)
- k-ìµœê·¼ì ‘ ì´ì›ƒ(kNN)
- ê°€ìš°ì‹œì•ˆ í”„ë¡œì„¸ìŠ¤
- ê²°ì • íŠ¸ë¦¬
- ì•™ìƒë¸” ê¸°ë²•
- ë‹¤ì¤‘ í´ë˜ìŠ¤ ë° ë‹¤ì¤‘ ì¶œë ¥ ì•Œê³ ë¦¬ì¦˜(ë‹¤ì¤‘ í´ë˜ìŠ¤ ë° ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜, ë‹¤ì¤‘ í´ë˜ìŠ¤ ë‹¤ì¤‘ ì¶œë ¥ ë¶„ë¥˜)



> ì§€ë„ í•™ìŠµ ì°¸ê³ : https://scikit-learn.org/stable/supervised_learning.html



#### ë¶„ë¥˜ê¸° ì„ íƒ ë°©ë²•

ë³´í†µ ì—¬ëŸ¬ ê°œë¥¼ ì‹¤í–‰í•´ë³´ê³  ì¢‹ì€ ê²°ê³¼ë¥¼ ì°¾ëŠ” ê²ƒì´ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì´ë‹¤. Scikit-learnì€ ìƒì„±ëœ ë°ì´í„°ì…‹ì— ëŒ€í•œ  [side-by-side comparison](https://scikit-learn.org/stable/auto_examples/classification/plot_classifier_comparison.html)ì„ ì œê³µí•˜ëŠ”ë°, ì´ê²ƒì€ KNeighbors, SVMì˜ ë‘ ê°€ì§€ ë°©ë²•(Linear, RBF), GaussianProcessClassifier, DecisionTreeClassifier, RandomForestClassifier, MLPClassifier, AdaBoostClassifier, GaussianNB and QuadraticDiscrinationAnalysisì„ ë¹„êµí•˜ê³  ê²°ê³¼ë¥¼ ì‹œê°í™”í•˜ì—¬ ë³´ì—¬ì¤€ë‹¤.

<img src="https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/2-Classifiers-1/images/comparison.png" alt="comparison of classifiers"  />



ê·¸ëŸ¬ë‚˜ ë§ˆêµ¬ ì¶”ì¸¡í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ë‚˜ì€ ë°©ë²•ì€ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•œ [ë¨¸ì‹ ëŸ¬ë‹ Cheat sheet](https://docs.microsoft.com/azure/machine-learning/algorithm-cheat-sheet?WT.mc_id=academic-15963-cxa)ì˜ ì•„ì´ë””ì–´ë¥¼ ë”°ë¥´ëŠ” ê²ƒì´ë‹¤. ì—¬ê¸°ì„œ,  ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¬¸ì œì— ëŒ€í•´ ëª‡ ê°€ì§€ ì„ íƒì‚¬í•­ì´ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

<img src="https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/2-Classifiers-1/images/cheatsheet.png" alt="cheatsheet for multiclass problems" style="zoom: 67%;" />

> Microsoftì˜ ì•Œê³ ë¦¬ì¦˜ ì¹˜íŠ¸ ì‹œíŠ¸ì˜ í•œ ë¶€ë¶„(ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ ì˜µì…˜ ìƒì„¸ ë‚´ì—­)



#### ì¶”ë¦¬

ìš°ë¦¬ê°€ ê°€ì§€ê³  ìˆëŠ” ì œì•½ ì¡°ê±´ë“¤ì„ ê³ ë ¤í•  ë•Œ, ë‹¤ë¥¸ ì ‘ê·¼ ë°©ì‹ë“¤ì„ í†µí•´ ë°©ë²•ì„ ì¶”ë¡ í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì.

- **ì‹ ê²½ë§ì€ ë„ˆë¬´ ë¬´ê²ë‹¤.** ì •ì œë˜ì—ˆì§€ë§Œ ì•„ì£¼ ì‘ì€ ë°ì´í„° ì…‹ê³¼, ë…¸íŠ¸ë¶ì„ í†µí•´ ë¡œì»¬ë¡œ í›ˆë ¨ì„ ì‹¤í–‰í•˜ê³  ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ê°ì•ˆí•  ë•Œ ì‹ ê²½ë§ì€ ì´ ì‘ì—…ì— ë„ˆë¬´ ë¬´ê²ë‹¤.
- **2-í´ë˜ìŠ¤ ë¶„ë¥˜ê¸°ê°€ ì—†ë‹¤.** ìš°ë¦¬ëŠ” 2-í´ë˜ìŠ¤ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, One-vs-All ë°©ì‹ì„ ë°°ì œí•œë‹¤.
- **ê²°ì • íŠ¸ë¦¬ ë˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ ì‘ë™í•  ìˆ˜ ìˆë‹¤.** ê²°ì • íŠ¸ë¦¬ê°€ ì‘ë™í•˜ê±°ë‚˜ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë°ì´í„°ì— ëŒ€í•´ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
- **ë‹¤ì¤‘ í´ë˜ìŠ¤ í–¥ìƒëœ ê²°ì • íŠ¸ë¦¬(Multiclass Boosted Decision Trees)ëŠ” ë‹¤ë¥¸ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.** ë‹¤ì¤‘ í´ë˜ìŠ¤ í–¥ìƒëœ ê²°ì • íŠ¸ë¦¬ëŠ” ì˜ˆë¥¼ ë“¤ì–´ ìˆœìœ„ë¥¼ êµ¬ì¶•í•˜ë„ë¡ ì„¤ê³„ëœ ì‘ì—…ê³¼ ê°™ì€ ë¹„íŒŒë¼ë¯¸í„° ì‘ì—…ì— ê°€ì¥ ì í•©í•˜ë¯€ë¡œ ìœ ìš©í•˜ì§€ ì•Šë‹¤.



#### Scikit-learn ì‚¬ìš©í•˜ê¸°

ìš°ë¦¬ëŠ” Scikit-learnì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶„ì„í•  ê²ƒì´ë‹¤. ê·¸ëŸ¬ë‚˜ Scikit-learnì—ì„œëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼  ì‚¬ìš©í•˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤. [ì „ë‹¬í•  íŒŒë¼ë¯¸í„°](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html?highlight=logistic regressio#sklearn.linear_model.LogisticRegression)ë¥¼ ì‚´í´ë³´ì.

ê¸°ë³¸ì ìœ¼ë¡œ Scikit-learnì— ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ìˆ˜í–‰í•˜ë„ë¡ ìš”ì²­í•  ë•Œ ì§€ì •í•´ì•¼ í•˜ëŠ” `multi_class`ì™€ `solver`ë¼ëŠ” ë‘ ê°€ì§€ ì¤‘ìš”í•œ íŒŒë¼ë¯¸í„°ê°€ ìˆë‹¤. `multi_class` ê°’ì€ íŠ¹ì • ë™ì‘ì„ ì ìš©í•œë‹¤. `solver`ì˜ ê°’ì€ ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ëª¨ë“  `solver`ë¥¼ ëª¨ë“  `multi_class` ê°’ê³¼ ìŒìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

ë¬¸ì„œì— ë”°ë¥´ë©´, ë‹¤ì¤‘ í´ë˜ìŠ¤ ì‚¬ë¡€ì—ì„œ í›ˆë ¨ ì•Œê³ ë¦¬ì¦˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:

- `multi_class` ì˜µì…˜ì´ `ovr`ë¡œ ì„¤ì •ëœ ê²½ìš°, **one-vs-rest(OvR)** schemeì„ ì‚¬ìš©í•œë‹¤.
- `multi_class` ì˜µì…˜ì´ `multinomial`ë¡œ ì„¤ì •ëœ ê²½ìš°, **êµì°¨ ì—”íŠ¸ë¡œí”¼ ì†ì‹¤(cross-entropy loss)**ì„ ì‚¬ìš©í•œë‹¤. (í˜„ì¬ ë‹¤í•­ì‹ ì˜µì…˜ì€ 'lbfgs', 'sag', 'saga' ë° 'newton-cg' solverì—ì„œë§Œ ì§€ì›ëœë‹¤.)

> ğŸ“ ì—¬ê¸°ì„œ schemeì€ 'ovr'(one-vs-rest) ë˜ëŠ” 'ë‹¤í•­ì‹'ì¼ ìˆ˜ ìˆë‹¤. ë¡œì§€ìŠ¤í‹± íšŒê·€ëŠ” ì‹¤ì œë¡œ ì´ì§„ ë¶„ë¥˜ë¥¼ ì§€ì›í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆê¸° ë•Œë¬¸ì—, ì´ëŸ¬í•œ ë°©ì‹ì„ í†µí•´ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ ì‘ì—…ì„ ë” ì˜ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

> ğŸ“ 'solver'ëŠ” "ìµœì í™” ë¬¸ì œì— ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜"ìœ¼ë¡œ ì •ì˜ëœë‹¤.

Scikit-learnì€ solverë“¤ì´ ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ë°ì´í„° êµ¬ì¡°ì—ì„œ ë‚˜íƒ€ë‚˜ëŠ” ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ëŠ” ì´ í‘œë¥¼ ì œê³µí•œë‹¤.

<img src="https://raw.githubusercontent.com/codingalzi/ML-For-Beginners/main/4-Classification/2-Classifiers-1/images/solvers.png" alt="img" style="zoom:50%;" />



### ë°ì´í„° ë¶„ë¦¬

---

í›ˆë ¨ ì‹œí—˜ì„ ìœ„í•´ ë¡œì§€ìŠ¤í‹± íšŒê·€ì— ì´ˆì ì„ ë§ì¶œ ìˆ˜ ìˆë‹¤. `train_test_split()`ì„ í˜¸ì¶œí•˜ì—¬ ë°ì´í„°ë¥¼ í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¦¬í•œë‹¤.

```python
X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df, cuisines_label_df, test_size=0.3)
```



### ë¡œì§€ìŠ¤í‹± íšŒê·€ ì ìš©

---

ë‹¤ì¤‘ í´ë˜ìŠ¤ ì‚¬ë¡€ë¥¼ ì‚¬ìš© ì¤‘ì´ë¯€ë¡œ ì‚¬ìš©í•  *scheme*ê³¼ ì„¤ì •í•  *solver*ë¥¼ ì„ íƒí•´ì•¼ í•œë‹¤. ë‹¤ì¤‘ í´ë˜ìŠ¤ ì„¤ì • ë° **liblinear** solverì™€ í•¨ê»˜ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ í›ˆë ¨í•œë‹¤.

1. multi_classë¥¼ `ovr`ë¡œ ì„¤ì •í•˜ê³  solverë¥¼ `liblinear`ë¡œ ì„¤ì •í•œ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ìƒì„±í•œë‹¤.

   ```python
   lr = LogisticRegression(multi_class='ovr',solver='liblinear')
   model = lr.fit(X_train, np.ravel(y_train))
   
   accuracy = model.score(X_test, y_test)
   print ("Accuracy is {}".format(accuracy))
   ```

   <span style="color:#a3a3a3;font-size:small;display:block;">

   Accuracy is 0.8015012510425354

   </span>

   

   ì •í™•ë„ê°€ 80%ê°€ ë„˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

   

   âœ… ê¸°ë³¸ìœ¼ë¡œ ìì£¼ ì„¤ì •ë˜ëŠ” `lbfgs`ê°™ì€ ë‹¤ë¥¸ solverë„ ì‹œë„í•´ë³´ì.

   > Pandas [`ravel`](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.ravel.html) í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ í•„ìš”í•  ë•Œ ë°ì´í„°ë¥¼ í‰í‰í•˜ê²Œ ë§Œë“ ë‹¤.

   

2. í•˜ë‚˜ì˜ ë°ì´í„° í–‰(#50)ì„ í…ŒìŠ¤íŠ¸í•˜ë©´ ì´ ëª¨ë¸ì´ ì‘ë™í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

   ```python
   print(f'ingredients: {X_test.iloc[50][X_test.iloc[50]!=0].keys()}')
   print(f'cuisine: {y_test.iloc[50]}')
   ```

   <span style="color:#a3a3a3;font-size:small;display:block;">

   ingredients: Index(['cilantro', 'onion', 'potato', 'tomato'], dtype='object')
   cuisine: indian

   </span>

   

3. ë” ê¹Šì´ ë“¤ì–´ê°€ì„œ, ì´ ì˜ˆì¸¡ì˜ ì •í™•ë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

   ```python
   test= X_test.iloc[50].values.reshape(-1, 1).T
   proba = model.predict_proba(test)
   classes = model.classes_
   resultdf = pd.DataFrame(data=proba, columns=classes)
   
   topPrediction = resultdf.T.sort_values(by=[0], ascending = [False])
   topPrediction.head()
   ```

   | index    | 0                     |
   | -------- | :---------|
   | indian   | 0\.753535 |
   | chinese  | 0\.164452 |
   | japanese | 0\.039409 |
   | thai     | 0\.023056 |
   | korean   | 0\.019548 |
   
   
   
4. ë¶„ë¥˜ ë³´ê³ ì„œë¥¼ ì¶œë ¥í•˜ì—¬ ë” ìì„¸íˆ ì•Œì•„ë³¸ë‹¤.

   ```python
   y_pred = model.predict(X_test)
   print(classification_report(y_test,y_pred))
   ```

   ```output
                 precision    recall  f1-score   support
   
        chinese       0.71      0.69      0.70       243
         indian       0.93      0.91      0.92       230
       japanese       0.79      0.76      0.77       248
         korean       0.80      0.80      0.80       249
           thai       0.80      0.86      0.83       229
   
       accuracy                           0.80      1199
      macro avg       0.80      0.80      0.80      1199
   weighted avg       0.80      0.80      0.80      1199
   ```
   
   



## 3. ìš”ë¦¬ ë¶„ë¥˜ê¸° 2

---

ìˆ«ì ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë” ë§ì€ ë°©ë²•ê³¼ í•œ ë¶„ë¥˜ê¸°ì™€ ë‹¤ë¥¸ ë¶„ë¥˜ê¸°ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´  ë¯¸ì¹˜ëŠ” ì˜í–¥ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì. 



### ë¶„ë¥˜ ì§€ë„

---

ìœ„ì—ì„œ Microsoftì˜ ì¹˜íŠ¸ ì‹œíŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ë‹¤. Scikit-learnì€ ì¶”ì •ê¸°(ë¶„ë¥˜ê¸°ì˜ ë‹¤ë¥¸ ìš©ì–´)ë¥¼ ë” ì¢íˆëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ìœ ì‚¬í•˜ì§€ë§Œ ë³´ë‹¤ ì„¸ë¶„í™”ëœ ì¹˜íŠ¸ ì‹œíŠ¸ë¥¼ ì œê³µí•œë‹¤.

<img src="https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/3-Classifiers-2/images/map.png" alt="ML Map from Scikit-learn" style="zoom:50%;" />

> Tip: [map online](https://scikit-learn.org/stable/tutorial/machine_learning_map/)ì— ì ‘ì†í•˜ê³  ê²½ë¡œë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ë¬¸ì„œë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤.



### ê³„íš

---

ì´ ì§€ë„ëŠ” ë°ì´í„°ë¥¼ ëª…í™•í•˜ê²Œ íŒŒì•…í•˜ë©´ ê²°ì •ì— ì´ë¥´ëŠ” ê²½ë¡œë¥¼ 'walk'í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë§¤ìš° ìœ ìš©í•˜ë‹¤.

- 50ê°œ ì´ìƒì˜ ìƒ˜í”Œì„ ê°€ì§€ê³  ìˆë‹¤.
- í•œ ë²”ì£¼ë¥¼ ì˜ˆì¸¡í•˜ê³  ì‹¶ë‹¤.
- ë ˆì´ë¸”ì´ ì§€ì •ëœ ë°ì´í„°ê°€ ìˆë‹¤.
- 10ë§Œê°œ ë¯¸ë§Œì˜ ìƒ˜í”Œì„ ê°€ì§€ê³  ìˆë‹¤.
- âœ¨ ì„ í˜• SVCë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤.
- ë§Œì•½ ì•ˆ ëœë‹¤ë©´, ìˆ˜ì¹˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì—
  - âœ¨ KNeighbors ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•´ ë³¼ ìˆ˜ ìˆë‹¤.
    - ê·¸ë˜ë„ ë¬¸ì œê°€ í•´ê²°ë˜ì§€ ì•Šìœ¼ë©´ âœ¨ SVC ë° âœ¨ ì•™ìƒë¸” ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•´ ë³¸ë‹¤.

ì´ê²ƒì€ ë”°ë¼ê°€ê¸°ì— ë§¤ìš° ë„ì›€ì´ ë˜ëŠ” ê¸¸ì´ë‹¤.



### ë°ì´í„° ë¶„ë¦¬

---

ì´ ê²½ë¡œë¥¼ ë”°ë¼ ì‚¬ìš©í•  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒë¶€í„° ì‹œì‘í•´ì•¼ í•œë‹¤.

1. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°:

   ```python
   from sklearn.neighbors import KNeighborsClassifier
   from sklearn.linear_model import LogisticRegression
   from sklearn.svm import SVC
   from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier
   from sklearn.model_selection import train_test_split, cross_val_score
   from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report, precision_recall_curve
   import numpy as npxxxxxxxxxxÂ from sklearn.neighbors import KNeighborsClassifierfrom sklearn.linear_model import LogisticRegressionfrom sklearn.svm import SVCfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifierfrom sklearn.model_selection import train_test_split, cross_val_scorefrom sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report, precision_recall_curveimport numpy as npfrom sklearn.neighbors import KNeighborsClassifierfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier
   ```

    

2. í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¶„ë¦¬í•˜ê¸°

   ```python
   X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df, cuisines_label_df, test_size=0.3)
   ```

    

### ì„ í˜• SVC ë¶„ë¥˜ê¸°

---

Support-Vector clustering(SVC)ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ê¸°ìˆ ì¸ Support-Vector machine ì˜ í•˜ìœ„ ê³„ì—´ì´ë‹¤. ì´ ë°©ë²•ì—ì„œëŠ” 'kernel'ì„ ì„ íƒí•˜ì—¬ ë ˆì´ë¸”ì„ êµ°ì§‘í™”í•˜ëŠ” ë°©ë²•ì„ ê²°ì •í•  ìˆ˜ ìˆë‹¤. 'C' íŒŒë¼ë¯¸í„°ëŠ” íŒŒë¼ë¯¸í„°ì˜ ì˜í–¥ì„ ì¡°ì ˆí•˜ëŠ” 'ê·œì œ'ë¥¼ ì˜ë¯¸í•œë‹¤. ì»¤ë„ì€ [ì—¬ëŸ¬ ê°€ì§€](https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC) ì¤‘ í•˜ë‚˜ì¼ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œëŠ” ì„ í˜• SVCë¥¼ í™œìš©í•˜ë„ë¡ 'linear'ìœ¼ë¡œ ì„¤ì •í•œë‹¤. ProbabilityëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 'false'ë¡œ ì„¤ì •ë˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” í™•ë¥  ì¶”ì •ì¹˜ë¥¼ ìˆ˜ì§‘í•˜ê¸° ìœ„í•´ 'true'ë¡œ ì„¤ì •í•œë‹¤. ê·¸ë¦¬ê³  í™•ë¥ ê°’ì„ ì–»ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ ì„ì–´ì•¼ í•˜ëŠ”ë°, ì´ë¥¼ ìœ„í•´ random stateë¥¼ '0'ìœ¼ë¡œ ì„¤ì •í•œë‹¤.



#### ì„ í˜• SVC ì ìš©

---

ë¶„ë¥˜ê¸° ë°°ì—´ì„ ë§Œë“œëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘í•˜ë©°, í…ŒìŠ¤íŠ¸í•˜ëŠ” ëŒ€ë¡œ ì´ ì–´ë ˆì´ì— ì ì§„ì ìœ¼ë¡œ ì¶”ê°€í•œë‹¤.



1. Linear SVCë¡œ ì‹œì‘í•˜ê¸°

   ```python
   C = 10
   # Create different classifiers.
   classifiers = {
       'Linear SVC': SVC(kernel='linear', C=C, probability=True,random_state=0)
   }
   ```

    

2. ëª¨ë¸ì„ Linear SVCë¡œ í›ˆë ¨í•˜ê³  ë³´ê³ ì„œ ì¶œë ¥

   ```python
   n_classifiers = len(classifiers)
   
   for index, (name, classifier) in enumerate(classifiers.items()):
       classifier.fit(X_train, np.ravel(y_train))
   
       y_pred = classifier.predict(X_test)
       accuracy = accuracy_score(y_test, y_pred)
       print("Accuracy (train) for %s: %0.1f%% " % (name, accuracy * 100))
       print(classification_report(y_test,y_pred))
   ```

   ```output
   Accuracy (train) for Linear SVC: 80.5% 
                 precision    recall  f1-score   support
   
        chinese       0.72      0.73      0.73       257
         indian       0.87      0.88      0.88       224
       japanese       0.82      0.77      0.79       228
         korean       0.85      0.77      0.81       253
           thai       0.78      0.88      0.82       237
   
       accuracy                           0.80      1199
      macro avg       0.81      0.81      0.81      1199
   weighted avg       0.81      0.80      0.80      1199
   
   ```
   
   ì •í™•ë„ 80.5%ë¡œ ê²°ê³¼ê°€ ê½¤ ì¢‹ë‹¤.



### K-Neighbors ë¶„ë¥˜ê¸°

---

K-NeighborsëŠ” ë¨¸ì‹ ëŸ¬ë‹ ë°©ë²•ì˜ "neighbors" ê³„ì—´ì˜ ì¼ë¶€ë¡œ, ì§€ë„ í•™ìŠµê³¼ ë¹„ì§€ë„ í•™ìŠµ ëª¨ë‘ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ ë°©ë²•ì—ì„œëŠ” ë°ì´í„°ì— ëŒ€í•œ ì¼ë°˜í™”ëœ ë ˆì´ë¸”ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆë„ë¡ ë¯¸ë¦¬ ì •ì˜ëœ ê°œìˆ˜ì˜ ì ì´ ìƒì„±ë˜ê³  ì´ëŸ¬í•œ ì  ì£¼ìœ„ì— ë°ì´í„°ê°€ ëª¨ì¸ë‹¤.



#### K-Neighbors ë¶„ë¥˜ê¸° ì ìš©

---

ì´ì „ì˜ ë¶„ë¥˜ê¸°ëŠ” ì¢‹ì•˜ê³ , ë°ì´í„°ì—ë„ ì˜ ì‘ë™í–ˆì§€ë§Œ, ì•„ë§ˆë„ ë” ë‚˜ì€ ì •í™•ë„ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. K-Neighbors ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•´ ë³´ì.

1. ë¶„ë¥˜ê¸° ë°°ì—´ì—ì„œ Linear SVC í•­ëª© ë’¤ì— ì‰¼í‘œë¥¼ ì¶”ê°€í•˜ê³   `'KNN classifier': KNeighborsClassifier(C)`ì¤„ì„ ì¶”ê°€í•œë‹¤.

   ```python
   classifiers = {
       'Linear SVC': SVC(kernel='linear', C=C, probability=True,random_state=0),
       'KNN classifier': KNeighborsClassifier(C),
   }
   ```

   ```output
   ~~~ Linear SVC ê²°ê³¼ ìƒëµ ~~~
   
   Accuracy (train) for KNN classifier: 73.9% 
                 precision    recall  f1-score   support
   
        chinese       0.72      0.69      0.70       257
         indian       0.84      0.81      0.83       224
       japanese       0.63      0.83      0.72       228
         korean       0.91      0.58      0.71       253
           thai       0.69      0.80      0.74       237
   
       accuracy                           0.74      1199
      macro avg       0.76      0.74      0.74      1199
   weighted avg       0.76      0.74      0.74      1199
   ```

   ì„ í˜• SVC ë¶„ë¥˜ê¸°ë³´ë‹¤ ë” ë‚˜ìœ ê²°ê³¼ë¥¼ ë³´ì¸ë‹¤.

   

   âœ… [K-Neighbors](https://scikit-learn.org/stable/modules/neighbors.html#neighbors) ì•Œì•„ë³´ê¸°



### Support Vector ë¶„ë¥˜ê¸°

---

Support-Vector ë¶„ë¥˜ê¸°ëŠ” ë¶„ë¥˜ ë° íšŒê·€ ì‘ì—…ì— ì‚¬ìš©ë˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ë°©ë²•ì˜ Support-Vector Machine ê³„ì—´ì˜ ì¼ë¶€ì´ë‹¤. SVMì€ ë‘ ë²”ì£¼ ê°„ì˜ ê±°ë¦¬ë¥¼ ìµœëŒ€í™”í•˜ê¸° ìœ„í•´ **ê³µê°„ ë‚´ ì§€ì ì— í›ˆë ¨ ì˜ˆì œë¥¼ ë§¤í•‘**í•œë‹¤. í›„ì† ë°ì´í„°ëŠ” í•´ë‹¹ ë²”ì£¼ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆë„ë¡ ì´ ê³µê°„ì— ë§¤í•‘ëœë‹¤.



#### Support Vector ë¶„ë¥˜ê¸° ì ìš©

---

Support Vector ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë” ë‚˜ì€ ì •í™•ë„ë¥¼ ìœ„í•´ ë…¸ë ¥í•´ ë³´ì.

1. K-Neighbors í•­ëª© ë’¤ì— ì‰¼í‘œë¥¼ ì¶”ê°€í•˜ê³  `'SVC': SVC(),`ë¥¼ ì¶”ê°€í•œë‹¤.

   ```python
   classifiers = {
       'Linear SVC': SVC(kernel='linear', C=C, probability=True,random_state=0),
       'KNN classifier': KNeighborsClassifier(C),
       'SVC': SVC(),
   }
   ```

   ```output
   ~~~ Linear SVC, KNN ê²°ê³¼ ìƒëµ ~~~
   
   Accuracy (train) for SVC: 84.7% 
                 precision    recall  f1-score   support
   
        chinese       0.76      0.79      0.77       257
         indian       0.92      0.92      0.92       224
       japanese       0.88      0.81      0.84       228
         korean       0.89      0.83      0.86       253
           thai       0.81      0.90      0.85       237
   
       accuracy                           0.85      1199
      macro avg       0.85      0.85      0.85      1199
   weighted avg       0.85      0.85      0.85      1199
   
   ```

   ì •í™•ë„ 84.7%ë¡œ ì§€ê¸ˆê¹Œì§€ì˜ ë¶„ë¥˜ê¸° ì¤‘ ê°€ì¥ ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì¸ë‹¤.

   

   âœ… [Support-Vectors](https://scikit-learn.org/stable/modules/svm.html#svm) ì•Œì•„ë³´ê¸°



### ì•™ìƒë¸” ë¶„ë¥˜ê¸°

---

ì§€ë‚œë²ˆ í…ŒìŠ¤íŠ¸ëŠ” ê½¤ ì¢‹ì•˜ì§€ë§Œ ëê¹Œì§€ í•´ë³´ì. ì•™ìƒë¸” ë¶„ë¥˜ê¸°, íŠ¹íˆ ëœë¤ í¬ë ˆìŠ¤íŠ¸ì™€ AdaBoostë¥¼ ì‚¬ìš©í•´ ë³´ì.

```python
classifiers = {
    'Linear SVC': SVC(kernel='linear', C=C, probability=True,random_state=0),
    'KNN classifier': KNeighborsClassifier(C),
    'SVC': SVC(),
    'RFST': RandomForestClassifier(n_estimators=100),
    'ADA': AdaBoostClassifier(n_estimators=100)
}
```

```output
~~~ Linear SVC, KNN,SVC  ê²°ê³¼ ìƒëµ ~~~

Accuracy (train) for RFST: 84.6% 
              precision    recall  f1-score   support

     chinese       0.79      0.84      0.81       257
      indian       0.89      0.91      0.90       224
    japanese       0.85      0.80      0.83       228
      korean       0.89      0.81      0.85       253
        thai       0.81      0.89      0.85       237

    accuracy                           0.85      1199
   macro avg       0.85      0.85      0.85      1199
weighted avg       0.85      0.85      0.85      1199

Accuracy (train) for ADA: 71.4% 
              precision    recall  f1-score   support

     chinese       0.62      0.46      0.53       257
      indian       0.91      0.87      0.89       224
    japanese       0.69      0.62      0.65       228
      korean       0.63      0.83      0.72       253
        thai       0.75      0.81      0.78       237

    accuracy                           0.71      1199
   macro avg       0.72      0.72      0.71      1199
weighted avg       0.72      0.71      0.71      1199

```

ëœë¤ í¬ë ˆìŠ¤íŠ¸ ë¶„ë¥˜ê¸°ëŠ” 84.6%, AdaBoostëŠ” 71.4%ë¡œ ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì¸ë‹¤.



âœ… [ì•™ìƒë¸” ë¶„ë¥˜ê¸°](https://scikit-learn.org/stable/modules/svm.html#svm) ì•Œì•„ë³´ê¸°



ì´ ë¨¸ì‹ ëŸ¬ë‹ ë°©ë²•ì€ ëª¨ë¸ì˜ í’ˆì§ˆì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ **ì—¬ëŸ¬ ê¸°ë³¸ ì¶”ì •ê¸°ì˜ ì˜ˆì¸¡ì„ ê²°í•©**í•œë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” ëœë¤ íŠ¸ë¦¬ì™€ AdaBoostë¥¼ ì‚¬ìš©í–ˆë‹¤.

- í‰ê· í™” ë°©ë²•ì¸ [ëœë¤ í¬ë ˆìŠ¤íŠ¸](https://scikit-learn.org/stable/modules/ensemble.html#forest)ëŠ” ê³¼ëŒ€ ì í•©ì„ í”¼í•˜ê¸° ìœ„í•´ ë¬´ì‘ìœ„ì„±ì´ ì£¼ì…ëœ **ê²°ì • íŠ¸ë¦¬**ì˜ **í¬ë ˆìŠ¤íŠ¸**ë¥¼ êµ¬ì¶•í•œë‹¤. n_estimators íŒŒë¼ë¯¸í„°ëŠ” íŠ¸ë¦¬ì˜ ê°œìˆ˜ë¡œ ì„¤ì •ëœë‹¤.

- [AdaBoost](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html)ëŠ” ë¶„ë¥˜ê¸°ë¥¼ ë°ì´í„° ì§‘í•©ì— fitì‹œí‚¨ ë‹¤ìŒ í•´ë‹¹ ë¶„ë¥˜ê¸°ì˜ ë³µì‚¬ë³¸ì„ ë™ì¼í•œ ë°ì´í„° ì§‘í•©ì— fitì‹œí‚¨ë‹¤. ì´ê²ƒì€ ì˜ëª» ë¶„ë¥˜ëœ í•­ëª©ì˜ ê°€ì¤‘ì¹˜ì— ì´ˆì ì„ ë§ì¶”ê³  ë‹¤ìŒ ë¶„ë¥˜ê¸°ê°€ ìˆ˜ì •í•  fitì„ ì¡°ì •í•œë‹¤.





## 4. ìš”ë¦¬ ì¶”ì²œ Web App êµ¬ì¶•

---

ìš”ë¦¬ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ë¶„ë¥˜ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê³ , Onnxì˜ ì›¹ ëŸ°íƒ€ì„ì„ í™œìš©í•˜ì—¬ ì €ì¥ëœ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‘ì€ ì›¹ ì•±ì„ ë§Œë“¤ ê²ƒì´ë‹¤.

ë¨¸ì‹ ëŸ¬ë‹ì˜ ê°€ì¥ ìœ ìš©í•œ ì‹¤ìš©ì ì¸ ì‚¬ìš© ë°©ë²• ì¤‘ í•˜ë‚˜ì¸ ì¶”ì²œ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•´ë³´ì.



### ëª¨ë¸ êµ¬ì¶•

---

ì‘ìš© ë¨¸ì‹ ëŸ¬ë‹ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì€ ë¹„ì¦ˆë‹ˆìŠ¤ ì‹œìŠ¤í…œì— ì´ëŸ¬í•œ ê¸°ìˆ ì„ í™œìš©í•˜ëŠ” ë° ìˆì–´ ì¤‘ìš”í•œ ë¶€ë¶„ì´ë‹¤. Onnxë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì‘ìš© í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ í•„ìš”í•œ ê²½ìš° ì˜¤í”„ë¼ì¸ ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.



ì´ ê³¼ì •ì—ì„œëŠ” ì¶”ë¡ ì„ ìœ„í•œ ê¸°ë³¸ JavaScript ê¸°ë°˜ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ë¨¼ì € ëª¨ë¸ì„ í›ˆë ¨í•˜ê³  Onnxì—ì„œ ì‚¬ìš©í•˜ë„ë¡ ë³€í™˜í•´ì•¼ í•œë‹¤.



### ë¶„ë¥˜ ëª¨ë¸ í›ˆë ¨

---

ë¨¼ì €, ì •ì œëœ ìš”ë¦¬ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ë¶„ë¥˜ ëª¨ë¸ì„ í›ˆë ¨í•œë‹¤.

1. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°

   ```python
   !pip install skl2onnx
   import pandas as pd 
   ```

   Scikit-learn ëª¨ë¸ì„ Onnx í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ë ¤ë©´ '[skl2onnx](https://onnx.ai/sklearn-onnx/)'ê°€ í•„ìš”í•˜ë‹¤.

   

2. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

   ```
   data = pd.read_csv(datapath+"cleaned_cuisines.csv")
   data.head()
   ```

   | index | Unnamed: 0 | cuisine | almond | angelica | anise | anise\_seed | apple | apple\_brandy | apricot | armagnac | artemisia | artichoke | asparagus | avocado | bacon | baked\_potato | balm | banana | barley | bartlett\_pear |
   | ----- | ---------- | ------- | ------ | -------- | ----- | ----------- | ----- | ------------- | ------- | -------- | --------- | --------- | --------- | ------- | ----- | ------------- | ---- | ------ | ------ | -------------- |
   | 0     | 0          | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   | 1     | 1          | indian  | 1      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   | 2     | 2          | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   | 3     | 3          | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |
   | 4     | 4          | indian  | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              |

    

3. ë¶ˆí•„ìš”í•œ ì²˜ìŒ ë‘ ì—´ì„ ì œê±°í•˜ê³  ë°ì´í„°ë¥¼ 'X'ë¼ê³  ì¬ëª…ëª…í•œë‹¤.

   ```
   X = data.iloc[:,2:]
   X.head()
   ```

   | index | almond | angelica | anise | anise\_seed | apple | apple\_brandy | apricot | armagnac | artemisia | artichoke | asparagus | avocado | bacon | baked\_potato | balm | banana | barley | bartlett\_pear | basil | bay  |
   | ----- | ------ | -------- | ----- | ----------- | ----- | ------------- | ------- | -------- | --------- | --------- | --------- | ------- | ----- | ------------- | ---- | ------ | ------ | -------------- | ----- | ---- |
   | 0     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 1     | 1      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 2     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 3     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |
   | 4     | 0      | 0        | 0     | 0           | 0     | 0             | 0       | 0        | 0         | 0         | 0         | 0       | 0     | 0             | 0    | 0      | 0      | 0              | 0     | 0    |

    

4. ë ˆì´ë¸”ì„ 'y'ë¡œ ì €ì¥í•œë‹¤.

   ```
   y = data[['cuisine']]
   y.head()
   ```

   | index | cuisine |
   | ----- | ------- |
   | 0     | indian  |
   | 1     | indian  |
   | 2     | indian  |
   | 3     | indian  |
   | 4     | indian  |



#### í›ˆë ¨ ë£¨í‹´ ì‹œì‘

---

ì •í™•ë„ê°€ ì¢‹ì€ 'SVC' ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤.

1. Scikit-learnì—ì„œ ì ì ˆí•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°

   ```python
   from sklearn.model_selection import train_test_split
   from sklearn.svm import SVC
   from sklearn.model_selection import cross_val_score
   from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report
   ```

    

2. í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ì…‹ ë¶„ë¦¬

   ```python
   X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3)
   ```

    

3. SVC ë¶„ë¥˜ ëª¨ë¸ êµ¬ì¶•

   ```python
   model = SVC(kernel='linear', C=10, probability=True,random_state=0)
   model.fit(X_train,y_train.values.ravel())
   ```

    

4. `predict()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ëª¨ë¸ í…ŒìŠ¤íŠ¸

   ```python
   y_pred = model.predict(X_test)
   ```

    

5. ëª¨ë¸ í’ˆì§ˆ í™•ì¸ì„ ìœ„í•´ ë¶„ë¥˜ ë³´ê³ ì„œ ì¶œë ¥

   ```python
   print(classification_report(y_test,y_pred))
   ```

   ```output
                 precision    recall  f1-score   support
   
        chinese       0.74      0.67      0.70       258
         indian       0.88      0.87      0.87       234
       japanese       0.74      0.75      0.74       238
         korean       0.83      0.75      0.79       240
           thai       0.72      0.86      0.78       229
   
       accuracy                           0.78      1199
      macro avg       0.78      0.78      0.78      1199
   weighted avg       0.78      0.78      0.78      1199
   ```

   ì •í™•ë„ê°€ ì¢‹ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.



#### Onxxë¡œ ëª¨ë¸ ë³€í™˜

---

ë°˜ë“œì‹œ ì ì ˆí•œ Tensor numberë¡œ ë³€í™˜í•´ì•¼ í•œë‹¤. ì´ ë°ì´í„°ì…‹ì—ëŠ” 380ê°œì˜ êµ¬ì„± ìš”ì†Œê°€ ë‚˜ì—´ë˜ì–´ ìˆìœ¼ë¯€ë¡œ `FloatTensorType`ì— í•´ë‹¹ ìˆ˜ë¥¼ ê¸°ë¡í•´ì•¼ í•œë‹¤.

1. tensor number 380ì„ ì‚¬ìš©í•˜ì—¬ ë³€í™˜

   ```python
   from skl2onnx import convert_sklearn
   from skl2onnx.common.data_types import FloatTensorType
   
   initial_type = [('float_input', FloatTensorType([None, 380]))]
   options = {id(model): {'nocl': True, 'zipmap': False}}
   ```

    

2. onxë¥¼ ìƒìƒí•˜ê³  model.onxx íŒŒì¼ì— ì €ì¥

   ```python
   onx = convert_sklearn(model, initial_types=initial_type, options=options)
   with open("./model.onnx", "wb") as f:
       f.write(onx.SerializeToString())
   ```

   > ë³€í™˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ [ì˜µì…˜](https://onnx.ai/sklearn-onnx/parameterized.html)ì„ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. ì´ ê²½ìš° 'nocl'ì„ Trueë¡œ, 'zipmap'ì„ Falseë¡œ ì „ë‹¬í–ˆë‹¤. ì´ ëª¨ë¸ì€ ë¶„ë¥˜ ëª¨ë¸ì´ê¸° ë•Œë¬¸ì— ì‚¬ì „ ëª©ë¡ì„ ìƒì„±í•˜ëŠ” ZipMapì„ ì œê±°í•  ìˆ˜ ìˆë‹¤(í•„ìˆ˜ ì•„ë‹˜). `nocl`ì€ ëª¨ë¸ì— í¬í•¨ëœ í´ë˜ìŠ¤ ì •ë³´ë¥¼ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ”ë‹¤. `nocl`ì„ 'True'ë¡œ ì„¤ì •í•˜ì—¬ ëª¨ë¸ í¬ê¸°ë¥¼ ì¤„ì¸ë‹¤.

ì „ì²´ ë…¸íŠ¸ë¶ì„ ì‹¤í–‰í•˜ë©´ Onnx ëª¨ë¸ì´ êµ¬ì¶•ë˜ì–´ ì´ í´ë”ì— ì €ì¥ëœë‹¤.



### ëª¨ë¸ ë³´ê¸°

---

Onnx ëª¨ë¸ì€ Visual Studio ì½”ë“œì—ì„œ ì˜ ë³´ì´ì§€ ì•Šì§€ë§Œ, ë§ì€ ì—°êµ¬ìë“¤ì´ ëª¨ë¸ì„ ì‹œê°í™”í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë§¤ìš° ì¢‹ì€ ë¬´ë£Œ ì†Œí”„íŠ¸ì›¨ì–´ê°€ ìˆë‹¤. [Netron](https://github.com/lutzroeder/Netron)ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  model.onnx íŒŒì¼ì„ ì—°ë‹¤. 380ê°œì˜ ì…ë ¥ê³¼ ë¶„ë¥˜ê¸°ê°€ ë‚˜ì—´ëœ ë‹¨ìˆœí•œ ëª¨ë¸ì„ ì‹œê°í™”í•  ìˆ˜ ìˆë‹¤.

<img src="https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/4-Applied/images/netron.png" alt="Netron visual" style="zoom: 80%;" />

Netronì€ ëª¨ë¸ì„ ë³´ëŠ” ë° ìœ ìš©í•œ ë„êµ¬ì´ë‹¤.

ì´ì œ ì›¹ ì•±ì—ì„œ ì´ ê¹”ë”í•œ ëª¨ë¸ì„ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤. ëƒ‰ì¥ê³  ì•ˆì„ ë³¼ ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì•±ì„ ë§Œë“¤ê³ , ëª¨ë¸ì— ì˜í•´ ê²°ì •ë˜ëŠ” ëŒ€ë¡œ, ì£¼ì–´ì§„ ìš”ë¦¬ë¥¼ ìš”ë¦¬í•˜ê¸° ìœ„í•´ ì–´ë–¤ ë‚¨ì€ ì¬ë£Œì˜ ì¡°í•©ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì.



### ì¶”ì²œ web application êµ¬ì¶•

---

ì›¹ ì•±ì—ì„œ ì§ì ‘ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë˜í•œ ì´ ì•„í‚¤í…ì²˜ë¥¼ í†µí•´ í•„ìš”í•œ ê²½ìš° ë¡œì»¬ ë° ì˜¤í”„ë¼ì¸ì—ì„œë„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. `model.onnx` íŒŒì¼ì„ ì €ì¥í•œ í´ë”ì™€ ë™ì¼í•œ í´ë”ì— `index.html` íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ê²ƒë¶€í„° ì‹œì‘í•˜ì.

1. *index.html* íŒŒì¼ì—ì„œ ë‹¤ìŒ markupì„ ì¶”ê°€í•œë‹¤.

   ```html
   <!DOCTYPE html>
   <html>
       <header>
           <title>Cuisine Matcher</title>
       </header>
       <body>
           ...
       </body>
   </html>
   ```

    

2. ì´ì œ `body` íƒœê·¸ ë‚´ì—ì„œ ì‘ì—…í•˜ë©´ì„œ ì¼ë¶€ ì‹ì¬ë£Œë¥¼ ë°˜ì˜í•˜ëŠ” ì²´í¬ë°•ìŠ¤ ëª©ë¡ì„ í‘œì‹œí•˜ê¸° ìœ„í•´ markupì„ ì¶”ê°€í•œë‹¤.

   ```html
   <h1>Check your refrigerator. What can you create?</h1>
           <div id="wrapper">
               <div class="boxCont">
                   <input type="checkbox" value="4" class="checkbox">
                   <label>apple</label>
               </div>
           
               <div class="boxCont">
                   <input type="checkbox" value="247" class="checkbox">
                   <label>pear</label>
               </div>
           
               <div class="boxCont">
                   <input type="checkbox" value="77" class="checkbox">
                   <label>cherry</label>
               </div>
   
               <div class="boxCont">
                   <input type="checkbox" value="126" class="checkbox">
                   <label>fenugreek</label>
               </div>
   
               <div class="boxCont">
                   <input type="checkbox" value="302" class="checkbox">
                   <label>sake</label>
               </div>
   
               <div class="boxCont">
                   <input type="checkbox" value="327" class="checkbox">
                   <label>soy sauce</label>
               </div>
   
               <div class="boxCont">
                   <input type="checkbox" value="112" class="checkbox">
                   <label>cumin</label>
               </div>
           </div>
           <div style="padding-top:10px">
               <button onClick="startInference()">What kind of cuisine can you make?</button>
           </div> 
   ```

   ê° ì²´í¬ë°•ìŠ¤ì—ëŠ” ê°’ì´ ì§€ì •ëœë‹¤. ì´ëŠ” ë°ì´í„°ì…‹ì— ë”°ë¼ ì‹ì¬ë£Œê°€ ë°œê²¬ë˜ëŠ” ì¸ë±ìŠ¤ë¥¼ ë°˜ì˜í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ ì•ŒíŒŒë²³ ëª©ë¡ì—ì„œ Appleì€ ë‹¤ì„¯ ë²ˆì§¸ ì—´ì„ ì°¨ì§€í•˜ê¸° ë•Œë¬¸ì—, 0ì—ì„œ ìˆ«ìë¥¼ ì„¸ê¸° ì‹œì‘í•  ë•Œ ê°’ì€ '4'ì´ë‹¤. [ingredients spreadsheet](https://github.com/codingalzi/ML-For-Beginners/blob/main/4-Classification/data/ingredient_indexes.csv)ë¥¼ ì°¸ì¡°í•˜ì—¬ íŠ¹ì • ì‹ì¬ë£Œì˜ ìƒ‰ì¸ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.

   *index.html* íŒŒì¼ì—ì„œ ì‘ì—…ì„ ê³„ì†í•˜ê³  ìµœì¢… ì¢…ë£Œ `</div>` ë’¤ì— ëª¨ë¸ì´ í˜¸ì¶œë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡ì„ ì¶”ê°€í•œë‹¤.

   

3. ë¨¼ì €, [Onnx Runtime](https://www.onnxruntime.ai/)ì„ ê°€ì ¸ì˜¨ë‹¤.

   ```html
   <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.9.0/dist/ort.min.js"></script> 
   ```

   >  Onnx ëŸ°íƒ€ì„ì€ ìµœì í™” ë° ì‚¬ìš©í•  APIë¥¼ í¬í•¨í•œ ê´‘ë²”ìœ„í•œ í•˜ë“œì›¨ì–´ í”Œë«í¼ì—ì„œ Onnx ëª¨ë¸ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.

   

4. ëŸ°íƒ€ì„ì´ ì„¤ì¹˜ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

   ```html
   <script>
       const ingredients = Array(380).fill(0);
       
       const checks = [...document.querySelectorAll('.checkbox')];
       
       checks.forEach(check => {
           check.addEventListener('change', function() {
               // toggle the state of the ingredient
               // based on the checkbox's value (1 or 0)
               ingredients[check.value] = check.checked ? 1 : 0;
           });
       });
   
       function testCheckboxes() {
           // validate if at least one checkbox is checked
           return checks.some(check => check.checked);
       }
   
       async function startInference() {
   
           let atLeastOneChecked = testCheckboxes()
   
           if (!atLeastOneChecked) {
               alert('Please select at least one ingredient.');
               return;
           }
           try {
               // create a new session and load the model.
               
               const session = await ort.InferenceSession.create('./model.onnx');
   
               const input = new ort.Tensor(new Float32Array(ingredients), [1, 380]);
               const feeds = { float_input: input };
   
               // feed inputs and run
               const results = await session.run(feeds);
   
               // read from results
               alert('You can enjoy ' + results.label.data[0] + ' cuisine today!')
   
           } catch (e) {
               console.log(`failed to inference ONNX model`);
               console.error(e);
           }
       }
              
   </script>
   ```

   ì´ ì½”ë“œì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ëª‡ ê°€ì§€ ì¼ì´ ë°œìƒí•œë‹¤.

   1. ì‹ì¬ë£Œ ì²´í¬ë°•ìŠ¤ê°€ ì„ íƒë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¼ 380ê°œì˜ ê°€ëŠ¥í•œ ê°’(1 ë˜ëŠ” 0)ì„ ì„¤ì •í•˜ê³  ì¶”ë¡ ì„ ìœ„í•œ ëª¨ë¸ë¡œ ì „ì†¡í•œë‹¤.

   2. ì²´í¬ë°•ìŠ¤ ë°°ì—´ì„ ìƒì„±í•˜ê³ , ì•±ì´ ì‹œì‘ë  ë•Œ í˜¸ì¶œë˜ëŠ” `init` í•¨ìˆ˜ë¡œ í™•ì¸ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ê²°ì •í•œë‹¤. ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•˜ë©´ ì„ íƒí•œ ì‹ì¬ë£Œë¥¼ ë°˜ì˜í•˜ë„ë¡ `ingredients` ë°°ì—´ì´ ë³€ê²½ëœë‹¤.

   3. ì²´í¬ë°•ìŠ¤ê°€ ì„ íƒë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” `testCheckboxes` í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤.

   4. ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `startInference` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³ , ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•˜ë©´ ì¶”ë¡ ì„ ì‹œì‘í•œë‹¤.

   5. ì¶”ë¡  ë£¨í‹´ì—ëŠ” ë‹¤ìŒì´ í¬í•¨ëœë‹¤.

      â…°. ëª¨ë¸ì˜ ë¹„ë™ê¸° ë¡œë“œ ì„¤ì •
      â…±. ëª¨ë¸ì— ë³´ë‚¼ Tensor êµ¬ì¡° ìƒì„±
      â…². ëª¨ë¸ì„ í›ˆë ¨í•  ë•Œ ë§Œë“  `float_input` ì…ë ¥ì„ ë°˜ì˜í•˜ëŠ” 'feeds' ìƒì„±(Netronì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì´ë¦„ì„ í™•ì¸í•  ìˆ˜ ìˆìŒ)
      â…³. ì´ëŸ¬í•œ 'feeds'ë¥¼ ëª¨ë¸ì— ë³´ë‚´ê³  ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ê¸°



### ì•± í…ŒìŠ¤íŠ¸

---

*index.html*íŒŒì¼ì´ ìˆëŠ” í´ë”ì•ˆì˜ Visual Studio Codeì—ì„œ í„°ë¯¸ë„ ì„¸ì…˜ì„ ì—°ë‹¤. [http-server](https://www.npmjs.com/package/http-server) ê°€ globalìœ¼ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  í”„ë¡¬í”„íŠ¸ì— `http-server`ë¥¼ ì…ë ¥í•œë‹¤. ë¡œì»¬ í˜¸ìŠ¤íŠ¸ê°€ ì—´ë¦¬ë©´ ì›¹ ì•±ì„ ë³¼ ìˆ˜ ìˆë‹¤. ë‹¤ì–‘í•œ ì‹ì¬ë£Œì— ë”°ë¼ ì–´ë–¤ ìš”ë¦¬ë¥¼ ì¶”ì²œí•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.

<img src="https://github.com/codingalzi/ML-For-Beginners/raw/main/4-Classification/4-Applied/images/web-app.png" alt="ingredient web app" style="zoom:50%;" />



[^ì¶œì²˜]: https://github.com/codingalzi/ML-For-Beginners/tree/main/4-Classification
